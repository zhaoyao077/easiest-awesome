[
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1453092378",
    "html_url": "https://github.com/apache/spark/pull/40262#issuecomment-1453092378",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40262",
    "id": 1453092378,
    "node_id": "IC_kwDOAQXtWs5WnG4a",
    "user": {
      "login": "zhengruifeng",
      "id": 7322292,
      "node_id": "MDQ6VXNlcjczMjIyOTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7322292?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zhengruifeng",
      "html_url": "https://github.com/zhengruifeng",
      "followers_url": "https://api.github.com/users/zhengruifeng/followers",
      "following_url": "https://api.github.com/users/zhengruifeng/following{/other_user}",
      "gists_url": "https://api.github.com/users/zhengruifeng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zhengruifeng/subscriptions",
      "organizations_url": "https://api.github.com/users/zhengruifeng/orgs",
      "repos_url": "https://api.github.com/users/zhengruifeng/repos",
      "events_url": "https://api.github.com/users/zhengruifeng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zhengruifeng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T07:25:18Z",
    "updated_at": "2023-03-03T07:27:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "just a idea, in this case what about:\r\n1,  Convert Global SortExec to Local SortExec;\r\n2, Make `SortExec` requires `SinglePartition`;\r\n\r\nin order to let one executor instead of driver to do the computation.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1453092378/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1453105982",
    "html_url": "https://github.com/apache/spark/pull/40262#issuecomment-1453105982",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40262",
    "id": 1453105982,
    "node_id": "IC_kwDOAQXtWs5WnKM-",
    "user": {
      "login": "ulysses-you",
      "id": 12025282,
      "node_id": "MDQ6VXNlcjEyMDI1Mjgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/12025282?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ulysses-you",
      "html_url": "https://github.com/ulysses-you",
      "followers_url": "https://api.github.com/users/ulysses-you/followers",
      "following_url": "https://api.github.com/users/ulysses-you/following{/other_user}",
      "gists_url": "https://api.github.com/users/ulysses-you/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ulysses-you/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ulysses-you/subscriptions",
      "organizations_url": "https://api.github.com/users/ulysses-you/orgs",
      "repos_url": "https://api.github.com/users/ulysses-you/repos",
      "events_url": "https://api.github.com/users/ulysses-you/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ulysses-you/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T07:41:04Z",
    "updated_at": "2023-03-03T07:46:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "@zhengruifeng thank you for your thought.\r\n \r\nThe original idea of driver sort is to avoid one shuffle. Requires SinglePartition seems does not help since it still requires a shuffle.\r\n\r\nBesides, finally, the result would go to driver, i.e. `df.sort.collect` (It's the reason I match `ReturnAnswer`), so it should be fine to do at driver. Plus, do sort at driver is not the first code place except driver sort. e.g., the merge function of rdd.takeOrdered. It should be safe if the size of plan is small enough.\r\n\r\nThe idea of Convert Global SortExec to Local SortExec and make SortExec requires SinglePartition looks fine that It can avoid the `sample` of range partitioner. But it seems orthogonal with this pr.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1453105982/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1455303198",
    "html_url": "https://github.com/apache/spark/pull/40262#issuecomment-1455303198",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40262",
    "id": 1455303198,
    "node_id": "IC_kwDOAQXtWs5Wvioe",
    "user": {
      "login": "ulysses-you",
      "id": 12025282,
      "node_id": "MDQ6VXNlcjEyMDI1Mjgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/12025282?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ulysses-you",
      "html_url": "https://github.com/ulysses-you",
      "followers_url": "https://api.github.com/users/ulysses-you/followers",
      "following_url": "https://api.github.com/users/ulysses-you/following{/other_user}",
      "gists_url": "https://api.github.com/users/ulysses-you/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ulysses-you/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ulysses-you/subscriptions",
      "organizations_url": "https://api.github.com/users/ulysses-you/orgs",
      "repos_url": "https://api.github.com/users/ulysses-you/repos",
      "events_url": "https://api.github.com/users/ulysses-you/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ulysses-you/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-06T01:43:44Z",
    "updated_at": "2023-03-06T01:43:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "cc @cloud-fan @viirya thank you",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1455303198/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1467021744",
    "html_url": "https://github.com/apache/spark/pull/40262#issuecomment-1467021744",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40262",
    "id": 1467021744,
    "node_id": "IC_kwDOAQXtWs5XcPmw",
    "user": {
      "login": "mridulm",
      "id": 1591700,
      "node_id": "MDQ6VXNlcjE1OTE3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mridulm",
      "html_url": "https://github.com/mridulm",
      "followers_url": "https://api.github.com/users/mridulm/followers",
      "following_url": "https://api.github.com/users/mridulm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mridulm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mridulm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mridulm/subscriptions",
      "organizations_url": "https://api.github.com/users/mridulm/orgs",
      "repos_url": "https://api.github.com/users/mridulm/repos",
      "events_url": "https://api.github.com/users/mridulm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mridulm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-13T21:57:45Z",
    "updated_at": "2023-03-13T21:58:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "Meta comment: moving this to the driver has potential for destabilizing the application.\r\nIn SPARK-36419, we added option to move the final `treeAggregate` to executor given the scale challenges seen when it is run at driver.\r\n\r\nOne option would be to do this in an executor as @zhengruifeng suggested, and that should be much more scalable as a solution.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1467021744/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
