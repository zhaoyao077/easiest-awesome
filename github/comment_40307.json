[
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1456844136",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1456844136",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1456844136,
    "node_id": "IC_kwDOAQXtWs5W1a1o",
    "user": {
      "login": "mridulm",
      "id": 1591700,
      "node_id": "MDQ6VXNlcjE1OTE3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mridulm",
      "html_url": "https://github.com/mridulm",
      "followers_url": "https://api.github.com/users/mridulm/followers",
      "following_url": "https://api.github.com/users/mridulm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mridulm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mridulm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mridulm/subscriptions",
      "organizations_url": "https://api.github.com/users/mridulm/orgs",
      "repos_url": "https://api.github.com/users/mridulm/repos",
      "events_url": "https://api.github.com/users/mridulm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mridulm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-06T19:39:11Z",
    "updated_at": "2023-03-06T19:39:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is still WIP, but want to get early feedback.\r\n+CC @Ngone51, @otterc, @waitinfuture",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1456844136/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1457000054",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1457000054",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1457000054,
    "node_id": "IC_kwDOAQXtWs5W2A52",
    "user": {
      "login": "mridulm",
      "id": 1591700,
      "node_id": "MDQ6VXNlcjE1OTE3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mridulm",
      "html_url": "https://github.com/mridulm",
      "followers_url": "https://api.github.com/users/mridulm/followers",
      "following_url": "https://api.github.com/users/mridulm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mridulm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mridulm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mridulm/subscriptions",
      "organizations_url": "https://api.github.com/users/mridulm/orgs",
      "repos_url": "https://api.github.com/users/mridulm/repos",
      "events_url": "https://api.github.com/users/mridulm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mridulm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-06T21:05:43Z",
    "updated_at": "2023-03-06T21:05:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "We are evaluating it currently @dongjoon-hyun :-)",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1457000054/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1457022823",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1457022823",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1457022823,
    "node_id": "IC_kwDOAQXtWs5W2Gdn",
    "user": {
      "login": "dongjoon-hyun",
      "id": 9700541,
      "node_id": "MDQ6VXNlcjk3MDA1NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9700541?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongjoon-hyun",
      "html_url": "https://github.com/dongjoon-hyun",
      "followers_url": "https://api.github.com/users/dongjoon-hyun/followers",
      "following_url": "https://api.github.com/users/dongjoon-hyun/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongjoon-hyun/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongjoon-hyun/subscriptions",
      "organizations_url": "https://api.github.com/users/dongjoon-hyun/orgs",
      "repos_url": "https://api.github.com/users/dongjoon-hyun/repos",
      "events_url": "https://api.github.com/users/dongjoon-hyun/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongjoon-hyun/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-06T21:23:47Z",
    "updated_at": "2023-03-06T21:23:47Z",
    "author_association": "MEMBER",
    "body": "If you don't mind, please share some results later~ :) ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1457022823/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1457315803",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1457315803",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1457315803,
    "node_id": "IC_kwDOAQXtWs5W3N_b",
    "user": {
      "login": "mridulm",
      "id": 1591700,
      "node_id": "MDQ6VXNlcjE1OTE3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mridulm",
      "html_url": "https://github.com/mridulm",
      "followers_url": "https://api.github.com/users/mridulm/followers",
      "following_url": "https://api.github.com/users/mridulm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mridulm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mridulm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mridulm/subscriptions",
      "organizations_url": "https://api.github.com/users/mridulm/orgs",
      "repos_url": "https://api.github.com/users/mridulm/repos",
      "events_url": "https://api.github.com/users/mridulm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mridulm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T01:13:16Z",
    "updated_at": "2023-03-07T01:13:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "The test failure is unrelated, so existing tests work fine - will work on specifically checking for the changes in this PR later today.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1457315803/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1457606879",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1457606879",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1457606879,
    "node_id": "IC_kwDOAQXtWs5W4VDf",
    "user": {
      "login": "jerqi",
      "id": 8159038,
      "node_id": "MDQ6VXNlcjgxNTkwMzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8159038?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jerqi",
      "html_url": "https://github.com/jerqi",
      "followers_url": "https://api.github.com/users/jerqi/followers",
      "following_url": "https://api.github.com/users/jerqi/following{/other_user}",
      "gists_url": "https://api.github.com/users/jerqi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jerqi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jerqi/subscriptions",
      "organizations_url": "https://api.github.com/users/jerqi/orgs",
      "repos_url": "https://api.github.com/users/jerqi/repos",
      "events_url": "https://api.github.com/users/jerqi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jerqi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T06:17:27Z",
    "updated_at": "2023-03-07T06:17:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @mridulm , thanks for your great work! Apache Uniffle is similar project to Apache Celeborn.  We also patched to the Apache Spark like https://github.com/apache/incubator-uniffle/blob/master/spark-patches/spark-3.2.1_dynamic_allocation_support.patch.  Considering that the shuffle data is stored in in distributed filesystem or in a disaggregated shuffle cluster, maybe  we should modify the method `ShuffledRowRDD#getPreferredLocations`, too.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1457606879/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1457619866",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1457619866",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1457619866,
    "node_id": "IC_kwDOAQXtWs5W4YOa",
    "user": {
      "login": "pan3793",
      "id": 26535726,
      "node_id": "MDQ6VXNlcjI2NTM1NzI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/26535726?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pan3793",
      "html_url": "https://github.com/pan3793",
      "followers_url": "https://api.github.com/users/pan3793/followers",
      "following_url": "https://api.github.com/users/pan3793/following{/other_user}",
      "gists_url": "https://api.github.com/users/pan3793/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pan3793/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pan3793/subscriptions",
      "organizations_url": "https://api.github.com/users/pan3793/orgs",
      "repos_url": "https://api.github.com/users/pan3793/repos",
      "events_url": "https://api.github.com/users/pan3793/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pan3793/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T06:32:50Z",
    "updated_at": "2023-03-07T06:32:50Z",
    "author_association": "MEMBER",
    "body": "@jerqi locality may still have benefits when RSS works in hybrid deployments, besides, there is a dedicated configuration for that `spark.shuffle.reduceLocality.enabled`",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1457619866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1457625037",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1457625037",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1457625037,
    "node_id": "IC_kwDOAQXtWs5W4ZfN",
    "user": {
      "login": "jerqi",
      "id": 8159038,
      "node_id": "MDQ6VXNlcjgxNTkwMzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8159038?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jerqi",
      "html_url": "https://github.com/jerqi",
      "followers_url": "https://api.github.com/users/jerqi/followers",
      "following_url": "https://api.github.com/users/jerqi/following{/other_user}",
      "gists_url": "https://api.github.com/users/jerqi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jerqi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jerqi/subscriptions",
      "organizations_url": "https://api.github.com/users/jerqi/orgs",
      "repos_url": "https://api.github.com/users/jerqi/repos",
      "events_url": "https://api.github.com/users/jerqi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jerqi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T06:38:32Z",
    "updated_at": "2023-03-07T06:42:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "> spark.shuffle.reduceLocality.enabled\r\n\r\nThanks, I got it. But if we want to use the locality when RSS works in hybrid deployments, should we expose an interface for ShuffleDriverComponent to provide `getPreferredLocationsForShuffle`.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1457625037/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1457723960",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1457723960",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1457723960,
    "node_id": "IC_kwDOAQXtWs5W4xo4",
    "user": {
      "login": "jerqi",
      "id": 8159038,
      "node_id": "MDQ6VXNlcjgxNTkwMzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8159038?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jerqi",
      "html_url": "https://github.com/jerqi",
      "followers_url": "https://api.github.com/users/jerqi/followers",
      "following_url": "https://api.github.com/users/jerqi/following{/other_user}",
      "gists_url": "https://api.github.com/users/jerqi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jerqi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jerqi/subscriptions",
      "organizations_url": "https://api.github.com/users/jerqi/orgs",
      "repos_url": "https://api.github.com/users/jerqi/repos",
      "events_url": "https://api.github.com/users/jerqi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jerqi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T08:05:04Z",
    "updated_at": "2023-03-07T08:05:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @jerqi locality may still have benefits when RSS works in hybrid deployments, besides, there is a dedicated configuration for that `spark.shuffle.reduceLocality.enabled`\r\n\r\n`ShuffledRdd#getPreferredLocations` will call the method `MapOutputTracker#getPreferredLocationsForShuffle` and `MapOutputTracker#getMapLocation`.\r\nFor `MapOutpuTracker#getMapLocation`, `spark.shuffle.reduceLocality.enabled` is useless. ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1457723960/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1458107057",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1458107057",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1458107057,
    "node_id": "IC_kwDOAQXtWs5W6PKx",
    "user": {
      "login": "waitinfuture",
      "id": 948245,
      "node_id": "MDQ6VXNlcjk0ODI0NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/948245?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/waitinfuture",
      "html_url": "https://github.com/waitinfuture",
      "followers_url": "https://api.github.com/users/waitinfuture/followers",
      "following_url": "https://api.github.com/users/waitinfuture/following{/other_user}",
      "gists_url": "https://api.github.com/users/waitinfuture/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/waitinfuture/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/waitinfuture/subscriptions",
      "organizations_url": "https://api.github.com/users/waitinfuture/orgs",
      "repos_url": "https://api.github.com/users/waitinfuture/repos",
      "events_url": "https://api.github.com/users/waitinfuture/events{/privacy}",
      "received_events_url": "https://api.github.com/users/waitinfuture/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T12:42:47Z",
    "updated_at": "2023-03-07T12:48:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "> This is still WIP, but want to get early feedback. +CC @Ngone51, @otterc, @waitinfuture\r\n\r\nHi @mridulm , thanks for the work and it really simplifies the usage of Apache Celeborn (and other similar systems)! This patch looks good to me.\r\n\r\nI totally agree with @pan3793 that in hybrid deployed environment, it'll benefit if locality can be exploited, and it's among future works of Apache Celeborn. Maybe we can add locality-related interface in ShuffleManager, because that is the base class that remote shuffle services overwrite.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1458107057/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1458674205",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1458674205",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1458674205,
    "node_id": "IC_kwDOAQXtWs5W8Zod",
    "user": {
      "login": "mridulm",
      "id": 1591700,
      "node_id": "MDQ6VXNlcjE1OTE3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mridulm",
      "html_url": "https://github.com/mridulm",
      "followers_url": "https://api.github.com/users/mridulm/followers",
      "following_url": "https://api.github.com/users/mridulm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mridulm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mridulm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mridulm/subscriptions",
      "organizations_url": "https://api.github.com/users/mridulm/orgs",
      "repos_url": "https://api.github.com/users/mridulm/repos",
      "events_url": "https://api.github.com/users/mridulm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mridulm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T19:00:46Z",
    "updated_at": "2023-03-07T19:05:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jerqi Agree that we should have a way to specify locality preference for disaggregated shuffle implementations to spark scheduler - so that shuffle tasks are closer to the data.\r\n\r\n@otterc is relooking at SPARK-25299, given the platform changes that have gone in since it was proposed - and propose changes in the upcoming months. We can add this to that discussion/jira.\r\n\r\nHope that sounds fine.\r\nFor now, as @pan3793 suggested, turning off reduce locality for Uniffle should remove the need for the code patch (once this PR is merged) - if there are gaps, we can address those specifically to enforce the behavior of `spark.shuffle.reduceLocality.enabled`.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1458674205/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459156913",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1459156913",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1459156913,
    "node_id": "IC_kwDOAQXtWs5W-Pex",
    "user": {
      "login": "jerqi",
      "id": 8159038,
      "node_id": "MDQ6VXNlcjgxNTkwMzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8159038?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jerqi",
      "html_url": "https://github.com/jerqi",
      "followers_url": "https://api.github.com/users/jerqi/followers",
      "following_url": "https://api.github.com/users/jerqi/following{/other_user}",
      "gists_url": "https://api.github.com/users/jerqi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jerqi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jerqi/subscriptions",
      "organizations_url": "https://api.github.com/users/jerqi/orgs",
      "repos_url": "https://api.github.com/users/jerqi/repos",
      "events_url": "https://api.github.com/users/jerqi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jerqi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T02:08:02Z",
    "updated_at": "2023-03-08T02:37:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "> > @jerqi locality may still have benefits when RSS works in hybrid deployments, besides, there is a dedicated configuration for that `spark.shuffle.reduceLocality.enabled`\r\n> \r\n> `ShuffledRdd#getPreferredLocations` will call the method `MapOutputTracker#getPreferredLocationsForShuffle` and `MapOutputTracker#getMapLocation`. For `MapOutpuTracker#getMapLocation`, `spark.shuffle.reduceLocality.enabled` is useless.\r\n\r\nMy mistake. I means  `ShuffledRowRdd#getPreferredLocations` instead of `ShuffledRdd#getPreferredLocations`",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459156913/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459167441",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1459167441",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1459167441,
    "node_id": "IC_kwDOAQXtWs5W-SDR",
    "user": {
      "login": "jerqi",
      "id": 8159038,
      "node_id": "MDQ6VXNlcjgxNTkwMzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8159038?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jerqi",
      "html_url": "https://github.com/jerqi",
      "followers_url": "https://api.github.com/users/jerqi/followers",
      "following_url": "https://api.github.com/users/jerqi/following{/other_user}",
      "gists_url": "https://api.github.com/users/jerqi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jerqi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jerqi/subscriptions",
      "organizations_url": "https://api.github.com/users/jerqi/orgs",
      "repos_url": "https://api.github.com/users/jerqi/repos",
      "events_url": "https://api.github.com/users/jerqi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jerqi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T02:17:48Z",
    "updated_at": "2023-03-08T02:36:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @jerqi Agree that we should have a way to specify locality preference for disaggregated shuffle implementations to spark scheduler - so that shuffle tasks are closer to the data.\r\n> \r\n> @otterc is relooking at [SPARK-25299](https://issues.apache.org/jira/browse/SPARK-25299), given the platform changes that have gone in since it was proposed - and propose changes in the upcoming months. We can add this to that discussion/jira.\r\n> \r\n> Hope that sounds fine. For now, as @pan3793 suggested, turning off reduce locality for Uniffle should remove the need for the code patch (once this PR is merged) - if there are gaps, we can address those specifically to enforce the behavior of `spark.shuffle.reduceLocality.enabled`.\r\n\r\nThere is some gaps. If we store data in the DFS or in disaggregated shuffle cluster. We should return `Nil` in the  `ShuffledRowRDD#getPreferredLocations`. For `CoalescedPartitionSpec`,  `spark.shuffle.reduceLocality.enabled` will help solve this problem. For `PartialReducerPartitionSpec`, `PartialMapperPartitionSpec` and `CoalescedMapperPartitionSpec `,  `spark.shuffle.reduceLocality.enabled`  can't help us. Because we call the method `MapOutpuTracker#getMapLocation`.\r\nCould we modify this method in this pr like?\r\n```\r\n  def getMapLocation(\r\n      dep: ShuffleDependency[_, _, _],\r\n      startMapIndex: Int,\r\n      endMapIndex: Int): Seq[String] =\r\n  {\r\n    val shuffleStatus = shuffleStatuses.get(dep.shuffleId).orNull\r\n    if (shuffleStatus != null || shuffleLocalityEnabled) {\r\n      shuffleStatus.withMapStatuses { statuses =>\r\n        if (startMapIndex < endMapIndex &&\r\n          (startMapIndex >= 0 && endMapIndex <= statuses.length)) {\r\n          val statusesPicked = statuses.slice(startMapIndex, endMapIndex).filter(_ != null)\r\n          statusesPicked.map(_.location.host).toSeq\r\n        } else {\r\n          Nil\r\n        }\r\n      }\r\n    } else {\r\n      Nil\r\n    }\r\n  }\r\n```\r\nOr we should raise an another pr to fix this issue?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459167441/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459618430",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1459618430",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1459618430,
    "node_id": "IC_kwDOAQXtWs5XAAJ-",
    "user": {
      "login": "mridulm",
      "id": 1591700,
      "node_id": "MDQ6VXNlcjE1OTE3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mridulm",
      "html_url": "https://github.com/mridulm",
      "followers_url": "https://api.github.com/users/mridulm/followers",
      "following_url": "https://api.github.com/users/mridulm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mridulm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mridulm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mridulm/subscriptions",
      "organizations_url": "https://api.github.com/users/mridulm/orgs",
      "repos_url": "https://api.github.com/users/mridulm/repos",
      "events_url": "https://api.github.com/users/mridulm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mridulm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T06:38:25Z",
    "updated_at": "2023-03-08T06:42:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jerqi the basic issue here is, `getPreferredLocations` in `ShuffledRowRDD` should return `Nil` at the very beginning in case `spark.shuffle.reduceLocality.enabled = false` (conceptually).\r\n\r\nThis logic is pushed into MapOutputTracker though - and `getPreferredLocationsForShuffle` honors `spark.shuffle.reduceLocality.enabled` - but `getMapLocation` does not.\r\n\r\nSo the fix would be to fix `getMapLocation` to honor the parameter.\r\n\r\nWe should fix this in a different PR though.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459618430/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459630906",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1459630906",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1459630906,
    "node_id": "IC_kwDOAQXtWs5XADM6",
    "user": {
      "login": "jerqi",
      "id": 8159038,
      "node_id": "MDQ6VXNlcjgxNTkwMzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8159038?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jerqi",
      "html_url": "https://github.com/jerqi",
      "followers_url": "https://api.github.com/users/jerqi/followers",
      "following_url": "https://api.github.com/users/jerqi/following{/other_user}",
      "gists_url": "https://api.github.com/users/jerqi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jerqi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jerqi/subscriptions",
      "organizations_url": "https://api.github.com/users/jerqi/orgs",
      "repos_url": "https://api.github.com/users/jerqi/repos",
      "events_url": "https://api.github.com/users/jerqi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jerqi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T06:55:50Z",
    "updated_at": "2023-03-08T06:55:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @jerqi the basic issue here is, `getPreferredLocations` in `ShuffledRowRDD` should return `Nil` at the very beginning in case `spark.shuffle.reduceLocality.enabled = false` (conceptually).\r\n> \r\n> This logic is pushed into MapOutputTracker though - and `getPreferredLocationsForShuffle` honors `spark.shuffle.reduceLocality.enabled` - but `getMapLocation` does not.\r\n> \r\n> So the fix would be to fix `getMapLocation` to honor the parameter.\r\n> \r\n> We should fix this in a different PR though.\r\n\r\n> \r\n\r\nCould I raise another pr to fix this issue?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459630906/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459652457",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1459652457",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1459652457,
    "node_id": "IC_kwDOAQXtWs5XAIdp",
    "user": {
      "login": "mridulm",
      "id": 1591700,
      "node_id": "MDQ6VXNlcjE1OTE3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mridulm",
      "html_url": "https://github.com/mridulm",
      "followers_url": "https://api.github.com/users/mridulm/followers",
      "following_url": "https://api.github.com/users/mridulm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mridulm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mridulm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mridulm/subscriptions",
      "organizations_url": "https://api.github.com/users/mridulm/orgs",
      "repos_url": "https://api.github.com/users/mridulm/repos",
      "events_url": "https://api.github.com/users/mridulm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mridulm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T07:21:03Z",
    "updated_at": "2023-03-08T07:21:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "Sure ! Please go ahead :-)",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459652457/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459802404",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1459802404",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1459802404,
    "node_id": "IC_kwDOAQXtWs5XAtEk",
    "user": {
      "login": "mridulm",
      "id": 1591700,
      "node_id": "MDQ6VXNlcjE1OTE3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mridulm",
      "html_url": "https://github.com/mridulm",
      "followers_url": "https://api.github.com/users/mridulm/followers",
      "following_url": "https://api.github.com/users/mridulm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mridulm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mridulm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mridulm/subscriptions",
      "organizations_url": "https://api.github.com/users/mridulm/orgs",
      "repos_url": "https://api.github.com/users/mridulm/repos",
      "events_url": "https://api.github.com/users/mridulm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mridulm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T09:06:23Z",
    "updated_at": "2023-03-08T09:06:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "Added tests, will wait for CI to complete.\r\n\r\n+CC @otterc, @Ngone51 ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459802404/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1461162897",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1461162897",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1461162897,
    "node_id": "IC_kwDOAQXtWs5XF5OR",
    "user": {
      "login": "mridulm",
      "id": 1591700,
      "node_id": "MDQ6VXNlcjE1OTE3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mridulm",
      "html_url": "https://github.com/mridulm",
      "followers_url": "https://api.github.com/users/mridulm/followers",
      "following_url": "https://api.github.com/users/mridulm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mridulm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mridulm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mridulm/subscriptions",
      "organizations_url": "https://api.github.com/users/mridulm/orgs",
      "repos_url": "https://api.github.com/users/mridulm/repos",
      "events_url": "https://api.github.com/users/mridulm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mridulm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-09T02:12:24Z",
    "updated_at": "2023-03-09T02:12:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the review @dongjoon-hyun ! Really helpful",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1461162897/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1461445933",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1461445933",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1461445933,
    "node_id": "IC_kwDOAQXtWs5XG-Ut",
    "user": {
      "login": "mridulm",
      "id": 1591700,
      "node_id": "MDQ6VXNlcjE1OTE3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mridulm",
      "html_url": "https://github.com/mridulm",
      "followers_url": "https://api.github.com/users/mridulm/followers",
      "following_url": "https://api.github.com/users/mridulm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mridulm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mridulm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mridulm/subscriptions",
      "organizations_url": "https://api.github.com/users/mridulm/orgs",
      "repos_url": "https://api.github.com/users/mridulm/repos",
      "events_url": "https://api.github.com/users/mridulm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mridulm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-09T07:09:07Z",
    "updated_at": "2023-03-09T07:09:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "All tests passed, merging to master.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1461445933/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1461449991",
    "html_url": "https://github.com/apache/spark/pull/40307#issuecomment-1461449991",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40307",
    "id": 1461449991,
    "node_id": "IC_kwDOAQXtWs5XG_UH",
    "user": {
      "login": "mridulm",
      "id": 1591700,
      "node_id": "MDQ6VXNlcjE1OTE3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mridulm",
      "html_url": "https://github.com/mridulm",
      "followers_url": "https://api.github.com/users/mridulm/followers",
      "following_url": "https://api.github.com/users/mridulm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mridulm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mridulm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mridulm/subscriptions",
      "organizations_url": "https://api.github.com/users/mridulm/orgs",
      "repos_url": "https://api.github.com/users/mridulm/repos",
      "events_url": "https://api.github.com/users/mridulm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mridulm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-09T07:12:05Z",
    "updated_at": "2023-03-09T07:12:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for all the reviews @dongjoon-hyun, @otterc, @jerqi, @pan3793 and @waitinfuture :-)",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1461449991/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
