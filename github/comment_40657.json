[
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1496046743",
    "html_url": "https://github.com/apache/spark/pull/40657#issuecomment-1496046743",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40657",
    "id": 1496046743,
    "node_id": "IC_kwDOAQXtWs5ZK9yX",
    "user": {
      "login": "liang3zy22",
      "id": 35164941,
      "node_id": "MDQ6VXNlcjM1MTY0OTQx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35164941?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/liang3zy22",
      "html_url": "https://github.com/liang3zy22",
      "followers_url": "https://api.github.com/users/liang3zy22/followers",
      "following_url": "https://api.github.com/users/liang3zy22/following{/other_user}",
      "gists_url": "https://api.github.com/users/liang3zy22/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/liang3zy22/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liang3zy22/subscriptions",
      "organizations_url": "https://api.github.com/users/liang3zy22/orgs",
      "repos_url": "https://api.github.com/users/liang3zy22/repos",
      "events_url": "https://api.github.com/users/liang3zy22/events{/privacy}",
      "received_events_url": "https://api.github.com/users/liang3zy22/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-04T14:11:54Z",
    "updated_at": "2023-04-04T14:11:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "@MaxGekk , I have updated the PR for all your review except the \"Could you trigger the error from user code, please. For example sql(\"select parse_url(...)\")\".\r\nI can't use sql function in StringExpressionsSuite.scala, don't know how to import the sql function. \r\nI have tried in UrlFunctionsSuite.scala using sql function. The test result reported:\r\n```\r\n[info] - url parse_url function *** FAILED *** (3 seconds, 922 milliseconds)\r\n[info]   Expected exception org.apache.spark.SparkIllegalArgumentException to be thrown, but no exception was thrown (UrlFunctionsSuite.scala:75)\r\n```  \r\n\r\nActually I firstly added test case in UrlFunctionSuite like I do now.scala to try to get the error, but I failed. I have tried to assign the sql code result to a variable and then call show method. The test case reported following error:\r\n```\r\n[info] - url parse_url function *** FAILED *** (4 seconds, 65 milliseconds)\r\n[info]   Expected exception org.apache.spark.SparkIllegalArgumentException to be thrown, but org.apache.spark.SparkException was thrown (UrlFunctionsSuite.scala:75)\r\n```\r\n\r\nThen I found StringExpressionsSuite.scala and tried in it. The error can be reproduced. So I don't know it can't be reproduced from user space or my method is wrong.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1496046743/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1496094989",
    "html_url": "https://github.com/apache/spark/pull/40657#issuecomment-1496094989",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40657",
    "id": 1496094989,
    "node_id": "IC_kwDOAQXtWs5ZLJkN",
    "user": {
      "login": "MaxGekk",
      "id": 1580697,
      "node_id": "MDQ6VXNlcjE1ODA2OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1580697?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MaxGekk",
      "html_url": "https://github.com/MaxGekk",
      "followers_url": "https://api.github.com/users/MaxGekk/followers",
      "following_url": "https://api.github.com/users/MaxGekk/following{/other_user}",
      "gists_url": "https://api.github.com/users/MaxGekk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MaxGekk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MaxGekk/subscriptions",
      "organizations_url": "https://api.github.com/users/MaxGekk/orgs",
      "repos_url": "https://api.github.com/users/MaxGekk/repos",
      "events_url": "https://api.github.com/users/MaxGekk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MaxGekk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-04T14:41:24Z",
    "updated_at": "2023-04-04T14:41:24Z",
    "author_association": "MEMBER",
    "body": "@liang3zy22 You need to run an action to trigger the execution exception like:\r\n```scala\r\n    withSQLConf(SQLConf.ANSI_ENABLED.key -> \"true\") {\r\n      val url = \"inva lid://user:pass@host/file;param?query;p2\"\r\n      checkError(\r\n        exception = intercept[SparkException] {\r\n          sql(s\"SELECT parse_url('$url', 'HOST')\").collect()\r\n        }.getCause.asInstanceOf[SparkThrowable],\r\n        errorClass = \"INVALID_URL\",\r\n        parameters = Map(\r\n          \"url\" -> url,\r\n          \"ansiConfig\" -> toSQLConf(SQLConf.ANSI_ENABLED.key)))\r\n    }\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1496094989/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1498579830",
    "html_url": "https://github.com/apache/spark/pull/40657#issuecomment-1498579830",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40657",
    "id": 1498579830,
    "node_id": "IC_kwDOAQXtWs5ZUoN2",
    "user": {
      "login": "MaxGekk",
      "id": 1580697,
      "node_id": "MDQ6VXNlcjE1ODA2OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1580697?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MaxGekk",
      "html_url": "https://github.com/MaxGekk",
      "followers_url": "https://api.github.com/users/MaxGekk/followers",
      "following_url": "https://api.github.com/users/MaxGekk/following{/other_user}",
      "gists_url": "https://api.github.com/users/MaxGekk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MaxGekk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MaxGekk/subscriptions",
      "organizations_url": "https://api.github.com/users/MaxGekk/orgs",
      "repos_url": "https://api.github.com/users/MaxGekk/repos",
      "events_url": "https://api.github.com/users/MaxGekk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MaxGekk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-06T06:53:52Z",
    "updated_at": "2023-04-06T06:53:52Z",
    "author_association": "MEMBER",
    "body": "@liang3zy22 Do you have an account at https://issues.apache.org/ ? I would like to resolve it and assign it to you.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1498579830/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1498590596",
    "html_url": "https://github.com/apache/spark/pull/40657#issuecomment-1498590596",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40657",
    "id": 1498590596,
    "node_id": "IC_kwDOAQXtWs5ZUq2E",
    "user": {
      "login": "liang3zy22",
      "id": 35164941,
      "node_id": "MDQ6VXNlcjM1MTY0OTQx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35164941?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/liang3zy22",
      "html_url": "https://github.com/liang3zy22",
      "followers_url": "https://api.github.com/users/liang3zy22/followers",
      "following_url": "https://api.github.com/users/liang3zy22/following{/other_user}",
      "gists_url": "https://api.github.com/users/liang3zy22/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/liang3zy22/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liang3zy22/subscriptions",
      "organizations_url": "https://api.github.com/users/liang3zy22/orgs",
      "repos_url": "https://api.github.com/users/liang3zy22/repos",
      "events_url": "https://api.github.com/users/liang3zy22/events{/privacy}",
      "received_events_url": "https://api.github.com/users/liang3zy22/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-06T07:04:46Z",
    "updated_at": "2023-04-06T07:06:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @liang3zy22 Do you have an account at https://issues.apache.org/ ? I would like to resolve it and assign it to you.\r\n\r\nI have. I already added comment in the JIRA issue SPARK-42844.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1498590596/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1498595729",
    "html_url": "https://github.com/apache/spark/pull/40657#issuecomment-1498595729",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40657",
    "id": 1498595729,
    "node_id": "IC_kwDOAQXtWs5ZUsGR",
    "user": {
      "login": "MaxGekk",
      "id": 1580697,
      "node_id": "MDQ6VXNlcjE1ODA2OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1580697?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MaxGekk",
      "html_url": "https://github.com/MaxGekk",
      "followers_url": "https://api.github.com/users/MaxGekk/followers",
      "following_url": "https://api.github.com/users/MaxGekk/following{/other_user}",
      "gists_url": "https://api.github.com/users/MaxGekk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MaxGekk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MaxGekk/subscriptions",
      "organizations_url": "https://api.github.com/users/MaxGekk/orgs",
      "repos_url": "https://api.github.com/users/MaxGekk/repos",
      "events_url": "https://api.github.com/users/MaxGekk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MaxGekk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-06T07:09:50Z",
    "updated_at": "2023-04-06T07:09:50Z",
    "author_association": "MEMBER",
    "body": "+1, LGTM. Merging to master.\r\nThank you, @liang3zy22 and @itholic for review.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1498595729/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1498597356",
    "html_url": "https://github.com/apache/spark/pull/40657#issuecomment-1498597356",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40657",
    "id": 1498597356,
    "node_id": "IC_kwDOAQXtWs5ZUsfs",
    "user": {
      "login": "MaxGekk",
      "id": 1580697,
      "node_id": "MDQ6VXNlcjE1ODA2OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1580697?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MaxGekk",
      "html_url": "https://github.com/MaxGekk",
      "followers_url": "https://api.github.com/users/MaxGekk/followers",
      "following_url": "https://api.github.com/users/MaxGekk/following{/other_user}",
      "gists_url": "https://api.github.com/users/MaxGekk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MaxGekk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MaxGekk/subscriptions",
      "organizations_url": "https://api.github.com/users/MaxGekk/orgs",
      "repos_url": "https://api.github.com/users/MaxGekk/repos",
      "events_url": "https://api.github.com/users/MaxGekk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MaxGekk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-06T07:11:34Z",
    "updated_at": "2023-04-06T07:11:34Z",
    "author_association": "MEMBER",
    "body": "@liang3zy22 Congratulations with your first contribution to Apache Spark!",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1498597356/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1498600699",
    "html_url": "https://github.com/apache/spark/pull/40657#issuecomment-1498600699",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40657",
    "id": 1498600699,
    "node_id": "IC_kwDOAQXtWs5ZUtT7",
    "user": {
      "login": "liang3zy22",
      "id": 35164941,
      "node_id": "MDQ6VXNlcjM1MTY0OTQx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35164941?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/liang3zy22",
      "html_url": "https://github.com/liang3zy22",
      "followers_url": "https://api.github.com/users/liang3zy22/followers",
      "following_url": "https://api.github.com/users/liang3zy22/following{/other_user}",
      "gists_url": "https://api.github.com/users/liang3zy22/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/liang3zy22/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liang3zy22/subscriptions",
      "organizations_url": "https://api.github.com/users/liang3zy22/orgs",
      "repos_url": "https://api.github.com/users/liang3zy22/repos",
      "events_url": "https://api.github.com/users/liang3zy22/events{/privacy}",
      "received_events_url": "https://api.github.com/users/liang3zy22/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-06T07:15:13Z",
    "updated_at": "2023-04-06T07:15:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "@MaxGekk and @itholic  , thanks for your patient review.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1498600699/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
