[
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1560343612",
    "html_url": "https://github.com/apache/spark/pull/41287#issuecomment-1560343612",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/41287",
    "id": 1560343612,
    "node_id": "IC_kwDOAQXtWs5dAPQ8",
    "user": {
      "login": "bersprockets",
      "id": 21131848,
      "node_id": "MDQ6VXNlcjIxMTMxODQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/21131848?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bersprockets",
      "html_url": "https://github.com/bersprockets",
      "followers_url": "https://api.github.com/users/bersprockets/followers",
      "following_url": "https://api.github.com/users/bersprockets/following{/other_user}",
      "gists_url": "https://api.github.com/users/bersprockets/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bersprockets/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bersprockets/subscriptions",
      "organizations_url": "https://api.github.com/users/bersprockets/orgs",
      "repos_url": "https://api.github.com/users/bersprockets/repos",
      "events_url": "https://api.github.com/users/bersprockets/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bersprockets/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-24T01:44:45Z",
    "updated_at": "2023-05-24T01:44:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "Is there some setting needed to materialize the issue? Using the queries you added as tests (in `scalar-subquery-predicate.sql` and `scalar-subquery-select.sql`), I am getting your expected results on the master branch:\r\n```\r\nspark-sql (default)> select version();\r\n3.5.0 5f325ec917ced819a19911b472ebf7eb52010203\r\nTime taken: 2.69 seconds, Fetched 1 row(s)\r\nspark-sql (default)> select *\r\n                   > from range(1, 3) t1\r\n                   > where (select sum(c) from (\r\n                   >         select t2.id * t2.id c\r\n                   >         from range (1, 2) t2 where t1.id = t2.id\r\n                   >         group by t2.id\r\n                   >        )\r\n                   > ) is not null;\r\n1\r\nTime taken: 1.141 seconds, Fetched 1 row(s)\r\nspark-sql (default)> select *\r\n                   > from\r\n                   > (\r\n                   >  select t1.id c1, (\r\n                   >                     select sum(c)\r\n                   >                     from (\r\n                   >                       select t2.id * t2.id c\r\n                   >                       from range (1, 2) t2 where t1.id = t2.id\r\n                   >                       group by t2.id\r\n                   >                     )\r\n                   >                    ) c2\r\n                   >  from range (1, 3) t1\r\n                   > ) t\r\n                   > where t.c2 is not null;\r\n1\t1\r\nTime taken: 0.404 seconds, Fetched 1 row(s)\r\nspark-sql (default)> \r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1560343612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1561664367",
    "html_url": "https://github.com/apache/spark/pull/41287#issuecomment-1561664367",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/41287",
    "id": 1561664367,
    "node_id": "IC_kwDOAQXtWs5dFRtv",
    "user": {
      "login": "agubichev",
      "id": 2280399,
      "node_id": "MDQ6VXNlcjIyODAzOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2280399?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/agubichev",
      "html_url": "https://github.com/agubichev",
      "followers_url": "https://api.github.com/users/agubichev/followers",
      "following_url": "https://api.github.com/users/agubichev/following{/other_user}",
      "gists_url": "https://api.github.com/users/agubichev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/agubichev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/agubichev/subscriptions",
      "organizations_url": "https://api.github.com/users/agubichev/orgs",
      "repos_url": "https://api.github.com/users/agubichev/repos",
      "events_url": "https://api.github.com/users/agubichev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/agubichev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-24T17:27:40Z",
    "updated_at": "2023-05-24T17:28:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Is there some setting needed to materialize the issue? Using the queries you added as tests (in `scalar-subquery-predicate.sql` and `scalar-subquery-select.sql`), I am getting your expected results on the master branch:\r\n> \r\n> ```\r\n> spark-sql (default)> select version();\r\n> 3.5.0 5f325ec917ced819a19911b472ebf7eb52010203\r\n> Time taken: 2.69 seconds, Fetched 1 row(s)\r\n> spark-sql (default)> select *\r\n>                    > from range(1, 3) t1\r\n>                    > where (select sum(c) from (\r\n>                    >         select t2.id * t2.id c\r\n>                    >         from range (1, 2) t2 where t1.id = t2.id\r\n>                    >         group by t2.id\r\n>                    >        )\r\n>                    > ) is not null;\r\n> 1\r\n> Time taken: 1.141 seconds, Fetched 1 row(s)\r\n> spark-sql (default)> select *\r\n>                    > from\r\n>                    > (\r\n>                    >  select t1.id c1, (\r\n>                    >                     select sum(c)\r\n>                    >                     from (\r\n>                    >                       select t2.id * t2.id c\r\n>                    >                       from range (1, 2) t2 where t1.id = t2.id\r\n>                    >                       group by t2.id\r\n>                    >                     )\r\n>                    >                    ) c2\r\n>                    >  from range (1, 3) t1\r\n>                    > ) t\r\n>                    > where t.c2 is not null;\r\n> 1\t1\r\n> Time taken: 0.404 seconds, Fetched 1 row(s)\r\n> spark-sql (default)> \r\n> ```\r\n\r\nGreat catch! I used the wrong query tests, updated them now. In both cases the results on the master branch are wrong:\r\n```\r\nselect * from (\r\n select t1.id c1, (\r\n  select t2.id c from range (1, 2) t2\r\n  where t1.id = t2.id  ) c2\r\n from range (1, 3) t1 ) t\r\nwhere t.c2 is not null\r\n-- !query schema\r\nstruct<c1:bigint,c2:bigint>\r\n-- !query output\r\n1\t1\r\n2\tNULL\r\n\r\n```\r\nand \r\n\r\n```\r\n-- !query\r\nselect *\r\nfrom range(1, 3) t1\r\nwhere (select t2.id c\r\n       from range (1, 2) t2 where t1.id = t2.id\r\n      ) is not null\r\n-- !query schema\r\nstruct<id:bigint>\r\n-- !query output\r\n1\r\n2\r\n```\r\n\r\n-- in both queries the second row should not be present.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1561664367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1561680423",
    "html_url": "https://github.com/apache/spark/pull/41287#issuecomment-1561680423",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/41287",
    "id": 1561680423,
    "node_id": "IC_kwDOAQXtWs5dFVon",
    "user": {
      "login": "sigmod",
      "id": 384788,
      "node_id": "MDQ6VXNlcjM4NDc4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/384788?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sigmod",
      "html_url": "https://github.com/sigmod",
      "followers_url": "https://api.github.com/users/sigmod/followers",
      "following_url": "https://api.github.com/users/sigmod/following{/other_user}",
      "gists_url": "https://api.github.com/users/sigmod/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sigmod/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sigmod/subscriptions",
      "organizations_url": "https://api.github.com/users/sigmod/orgs",
      "repos_url": "https://api.github.com/users/sigmod/repos",
      "events_url": "https://api.github.com/users/sigmod/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sigmod/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-24T17:39:47Z",
    "updated_at": "2023-05-24T17:39:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "@gengliangwang  @cloud-fan ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1561680423/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1561760662",
    "html_url": "https://github.com/apache/spark/pull/41287#issuecomment-1561760662",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/41287",
    "id": 1561760662,
    "node_id": "IC_kwDOAQXtWs5dFpOW",
    "user": {
      "login": "bersprockets",
      "id": 21131848,
      "node_id": "MDQ6VXNlcjIxMTMxODQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/21131848?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bersprockets",
      "html_url": "https://github.com/bersprockets",
      "followers_url": "https://api.github.com/users/bersprockets/followers",
      "following_url": "https://api.github.com/users/bersprockets/following{/other_user}",
      "gists_url": "https://api.github.com/users/bersprockets/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bersprockets/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bersprockets/subscriptions",
      "organizations_url": "https://api.github.com/users/bersprockets/orgs",
      "repos_url": "https://api.github.com/users/bersprockets/repos",
      "events_url": "https://api.github.com/users/bersprockets/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bersprockets/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-24T18:43:29Z",
    "updated_at": "2023-05-24T18:43:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "Makes more sense now. Can you update the Jira as well?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1561760662/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1561843655",
    "html_url": "https://github.com/apache/spark/pull/41287#issuecomment-1561843655",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/41287",
    "id": 1561843655,
    "node_id": "IC_kwDOAQXtWs5dF9fH",
    "user": {
      "login": "agubichev",
      "id": 2280399,
      "node_id": "MDQ6VXNlcjIyODAzOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2280399?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/agubichev",
      "html_url": "https://github.com/agubichev",
      "followers_url": "https://api.github.com/users/agubichev/followers",
      "following_url": "https://api.github.com/users/agubichev/following{/other_user}",
      "gists_url": "https://api.github.com/users/agubichev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/agubichev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/agubichev/subscriptions",
      "organizations_url": "https://api.github.com/users/agubichev/orgs",
      "repos_url": "https://api.github.com/users/agubichev/repos",
      "events_url": "https://api.github.com/users/agubichev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/agubichev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-24T19:52:44Z",
    "updated_at": "2023-05-24T19:52:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Updated Jira ticket too",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1561843655/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1563005932",
    "html_url": "https://github.com/apache/spark/pull/41287#issuecomment-1563005932",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/41287",
    "id": 1563005932,
    "node_id": "IC_kwDOAQXtWs5dKZPs",
    "user": {
      "login": "cloud-fan",
      "id": 3182036,
      "node_id": "MDQ6VXNlcjMxODIwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3182036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cloud-fan",
      "html_url": "https://github.com/cloud-fan",
      "followers_url": "https://api.github.com/users/cloud-fan/followers",
      "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}",
      "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions",
      "organizations_url": "https://api.github.com/users/cloud-fan/orgs",
      "repos_url": "https://api.github.com/users/cloud-fan/repos",
      "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cloud-fan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-25T14:25:57Z",
    "updated_at": "2023-05-25T14:25:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "LGTM, can we fix the conflicts?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1563005932/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1563084087",
    "html_url": "https://github.com/apache/spark/pull/41287#issuecomment-1563084087",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/41287",
    "id": 1563084087,
    "node_id": "IC_kwDOAQXtWs5dKsU3",
    "user": {
      "login": "agubichev",
      "id": 2280399,
      "node_id": "MDQ6VXNlcjIyODAzOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2280399?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/agubichev",
      "html_url": "https://github.com/agubichev",
      "followers_url": "https://api.github.com/users/agubichev/followers",
      "following_url": "https://api.github.com/users/agubichev/following{/other_user}",
      "gists_url": "https://api.github.com/users/agubichev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/agubichev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/agubichev/subscriptions",
      "organizations_url": "https://api.github.com/users/agubichev/orgs",
      "repos_url": "https://api.github.com/users/agubichev/repos",
      "events_url": "https://api.github.com/users/agubichev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/agubichev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-25T15:13:51Z",
    "updated_at": "2023-05-25T15:13:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "Conflicts are resolved.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1563084087/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
