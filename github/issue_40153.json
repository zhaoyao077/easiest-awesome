{
  "url": "https://api.github.com/repos/apache/spark/issues/40153",
  "repository_url": "https://api.github.com/repos/apache/spark",
  "labels_url": "https://api.github.com/repos/apache/spark/issues/40153/labels{/name}",
  "comments_url": "https://api.github.com/repos/apache/spark/issues/40153/comments",
  "events_url": "https://api.github.com/repos/apache/spark/issues/40153/events",
  "html_url": "https://github.com/apache/spark/pull/40153",
  "id": 1597831741,
  "node_id": "PR_kwDOAQXtWs5KqFCB",
  "number": 40153,
  "title": "[SPARK-42547][PYTHON] Make PySpark working with Python 3.7",
  "user": {
    "login": "HyukjinKwon",
    "id": 6477701,
    "node_id": "MDQ6VXNlcjY0Nzc3MDE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6477701?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/HyukjinKwon",
    "html_url": "https://github.com/HyukjinKwon",
    "followers_url": "https://api.github.com/users/HyukjinKwon/followers",
    "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}",
    "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions",
    "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs",
    "repos_url": "https://api.github.com/users/HyukjinKwon/repos",
    "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1405801475,
      "node_id": "MDU6TGFiZWwxNDA1ODAxNDc1",
      "url": "https://api.github.com/repos/apache/spark/labels/ML",
      "name": "ML",
      "color": "ededed",
      "default": false,
      "description": null
    },
    {
      "id": 1981527456,
      "node_id": "MDU6TGFiZWwxOTgxNTI3NDU2",
      "url": "https://api.github.com/repos/apache/spark/labels/CORE",
      "name": "CORE",
      "color": "ededed",
      "default": false,
      "description": null
    },
    {
      "id": 1982260031,
      "node_id": "MDU6TGFiZWwxOTgyMjYwMDMx",
      "url": "https://api.github.com/repos/apache/spark/labels/PYTHON",
      "name": "PYTHON",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2023-02-24T03:14:10Z",
  "updated_at": "2023-02-25T01:31:31Z",
  "closed_at": "2023-02-24T05:15:39Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/apache/spark/pulls/40153",
    "html_url": "https://github.com/apache/spark/pull/40153",
    "diff_url": "https://github.com/apache/spark/pull/40153.diff",
    "patch_url": "https://github.com/apache/spark/pull/40153.patch",
    "merged_at": null
  },
  "body": "### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to avoid new Python typing syntax that causes the test failure in lower Python version.\r\n\r\n### Why are the changes needed?\r\n\r\nPython 3.7 support is broken:\r\n\r\n```\r\n+ ./python/run-tests --python-executables=python3\r\nRunning PySpark tests. Output is in /home/ec2-user/spark/python/unit-tests.log\r\nWill test against the following Python executables: ['python3']\r\nWill test the following Python modules: ['pyspark-connect', 'pyspark-core', 'pyspark-errors', 'pyspark-ml', 'pyspark-mllib', 'pyspark-pandas', 'pyspark-pandas-slow', 'pyspark-resource', 'pyspark-sql', 'pyspark-streaming']\r\npython3 python_implementation is CPython\r\npython3 version is: Python 3.7.16\r\nStarting test(python3): pyspark.ml.tests.test_feature (temp output: /home/ec2-user/spark/python/target/8ca9ab1a-05cc-4845-bf89-30d9001510bc/python3__pyspark.ml.tests.test_feature__kg6sseie.log)\r\nStarting test(python3): pyspark.ml.tests.test_base (temp output: /home/ec2-user/spark/python/target/f2264f3b-6b26-4e61-9452-8d6ddd7eb002/python3__pyspark.ml.tests.test_base__0902zf9_.log)\r\nStarting test(python3): pyspark.ml.tests.test_algorithms (temp output: /home/ec2-user/spark/python/target/d1dc4e07-e58c-4c03-abe5-09d8fab22e6a/python3__pyspark.ml.tests.test_algorithms__lh3wb2u8.log)\r\nStarting test(python3): pyspark.ml.tests.test_evaluation (temp output: /home/ec2-user/spark/python/target/3f42dc79-c945-4cf2-a1eb-83e72b40a9ee/python3__pyspark.ml.tests.test_evaluation__89idc7fa.log)\r\nFinished test(python3): pyspark.ml.tests.test_base (16s)\r\nStarting test(python3): pyspark.ml.tests.test_functions (temp output: /home/ec2-user/spark/python/target/5a3b90f0-216b-4edd-9d15-6619d3e03300/python3__pyspark.ml.tests.test_functions__g5u1290s.log)\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.7/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/lib64/python3.7/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/ec2-user/spark/python/pyspark/ml/tests/test_functions.py\", line 21, in <module>\r\n    from pyspark.ml.functions import predict_batch_udf\r\n  File \"/home/ec2-user/spark/python/pyspark/ml/functions.py\", line 38, in <module>\r\n    from typing import Any, Callable, Iterator, List, Mapping, Protocol, TYPE_CHECKING, Tuple, Union\r\nImportError: cannot import name 'Protocol' from 'typing' (/usr/lib64/python3.7/typing.py)\r\nHad test failures in pyspark.ml.tests.test_functions with python3; see logs.\r\n```\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nThis change has not been released out yet so no user-facing change. But this is a release blocker.\r\n\r\n### How was this patch tested?\r\n\r\nManually tested via:\r\n\r\n```bash\r\n./python/run-tests --python-executables=python3.7\r\n```\r\n",
  "closed_by": {
    "login": "dongjoon-hyun",
    "id": 9700541,
    "node_id": "MDQ6VXNlcjk3MDA1NDE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9700541?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dongjoon-hyun",
    "html_url": "https://github.com/dongjoon-hyun",
    "followers_url": "https://api.github.com/users/dongjoon-hyun/followers",
    "following_url": "https://api.github.com/users/dongjoon-hyun/following{/other_user}",
    "gists_url": "https://api.github.com/users/dongjoon-hyun/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dongjoon-hyun/subscriptions",
    "organizations_url": "https://api.github.com/users/dongjoon-hyun/orgs",
    "repos_url": "https://api.github.com/users/dongjoon-hyun/repos",
    "events_url": "https://api.github.com/users/dongjoon-hyun/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dongjoon-hyun/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/apache/spark/issues/40153/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/apache/spark/issues/40153/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
