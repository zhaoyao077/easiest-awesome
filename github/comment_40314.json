[
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1457967882",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1457967882",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1457967882,
    "node_id": "IC_kwDOAQXtWs5W5tMK",
    "user": {
      "login": "AngersZhuuuu",
      "id": 46485123,
      "node_id": "MDQ6VXNlcjQ2NDg1MTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/46485123?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AngersZhuuuu",
      "html_url": "https://github.com/AngersZhuuuu",
      "followers_url": "https://api.github.com/users/AngersZhuuuu/followers",
      "following_url": "https://api.github.com/users/AngersZhuuuu/following{/other_user}",
      "gists_url": "https://api.github.com/users/AngersZhuuuu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AngersZhuuuu/subscriptions",
      "organizations_url": "https://api.github.com/users/AngersZhuuuu/orgs",
      "repos_url": "https://api.github.com/users/AngersZhuuuu/repos",
      "events_url": "https://api.github.com/users/AngersZhuuuu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AngersZhuuuu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T10:59:55Z",
    "updated_at": "2023-03-07T10:59:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "ping @cloud-fan @dongjoon-hyun @HyukjinKwon ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1457967882/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459223471",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1459223471",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1459223471,
    "node_id": "IC_kwDOAQXtWs5W-fuv",
    "user": {
      "login": "AngersZhuuuu",
      "id": 46485123,
      "node_id": "MDQ6VXNlcjQ2NDg1MTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/46485123?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AngersZhuuuu",
      "html_url": "https://github.com/AngersZhuuuu",
      "followers_url": "https://api.github.com/users/AngersZhuuuu/followers",
      "following_url": "https://api.github.com/users/AngersZhuuuu/following{/other_user}",
      "gists_url": "https://api.github.com/users/AngersZhuuuu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AngersZhuuuu/subscriptions",
      "organizations_url": "https://api.github.com/users/AngersZhuuuu/orgs",
      "repos_url": "https://api.github.com/users/AngersZhuuuu/repos",
      "events_url": "https://api.github.com/users/AngersZhuuuu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AngersZhuuuu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T02:50:40Z",
    "updated_at": "2023-03-08T02:50:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Hi, @AngersZhuuuu .\r\n> This PR seems to have insufficient information. Could you provide more details about how to validate this in what environment?\r\n\r\nWe run a client mode SparkSubmit job and throw below exception\r\n```\r\n23/03/07 18:34:50 INFO YarnClientSchedulerBackend: Shutting down all executors\r\n23/03/07 18:34:50 INFO YarnSchedulerBackend$YarnDriverEndpoint: Asking each executor to shut down\r\n23/03/07 18:34:50 INFO YarnClientSchedulerBackend: YARN client scheduler backend Stopped\r\n23/03/07 18:34:50 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!\r\n23/03/07 18:34:50 INFO BlockManager: BlockManager stopped\r\n23/03/07 18:34:50 INFO BlockManagerMaster: BlockManagerMaster stopped\r\n23/03/07 18:34:50 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!\r\n23/03/07 18:34:50 INFO SparkContext: Successfully stopped SparkContext\r\nException in thread \"main\" org.apache.spark.sql.AnalysisException: Table or view not found: xxx.xxx; line 1 pos 14;\r\n'GlobalLimit 1\r\n+- 'LocalLimit 1\r\n   +- 'Project [*]\r\n      +- 'UnresolvedRelation [xxx, xxx], [], false\r\n\r\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\r\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:115)\r\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1$adapted(CheckAnalysis.scala:95)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:184)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:183)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:183)\r\n\tat scala.collection.immutable.List.foreach(List.scala:392)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:183)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:183)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:183)\r\n\tat scala.collection.immutable.List.foreach(List.scala:392)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:183)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:183)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:183)\r\n\tat scala.collection.immutable.List.foreach(List.scala:392)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:183)\r\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:95)\r\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:92)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:155)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:178)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:228)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:175)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:73)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:143)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:778)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:143)\r\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:73)\r\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:71)\r\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:63)\r\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:98)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:778)\r\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:96)\r\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:621)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:778)\r\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:616)\r\n\tat org.apache.spark.sql.auth.QueryAuthChecker$.main(QueryAuthChecker.scala:33)\r\n\tat org.apache.spark.sql.auth.QueryAuthChecker.main(QueryAuthChecker.scala)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\r\n\tat org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:958)\r\n\tat org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)\r\n\tat org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)\r\n\tat org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)\r\n\tat org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1046)\r\n\tat org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1055)\r\n\tat org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\r\n23/03/07 18:34:50 INFO ShutdownHookManager: Shutdown hook called\r\n23/03/07 18:34:50 INFO ShutdownHookManager: Deleting directory /tmp/spark-8ce833e1-3cd4-4a9f-960d-695be85b12f4\r\n23/03/07 18:34:50 INFO ShutdownHookManager: Deleting directory /hadoop/spark/sparklocaldir/spark-58bbd530-6144-4ad6-b62b-a690baac9f96\r\n23/03/07 18:34:50 INFO SparkExecutionPlanProcessor: Lineage thread pool prepares to shut down\r\n23/03/07 18:34:50 INFO SparkExecutionPlanProcessor: Lineage thread pool finishes to await termination and shuts down\r\n\r\n```\r\n\r\n\r\nThis job failed, but with call `sparkContext.stop()`, client side failed but in AM it shows SUCCESS\r\nIn spark-3.1.2 the code like this\r\n```\r\n    try {\r\n      app.start(childArgs.toArray, sparkConf)\r\n    } catch {\r\n      case t: Throwable =>\r\n        throw findCause(t)\r\n    } finally {\r\n      if (!isShell(args.primaryResource) && !isSqlShell(args.mainClass) &&\r\n        !isThriftServer(args.mainClass)) {\r\n        try {\r\n          SparkContext.getActive.foreach(_.stop())\r\n        } catch {\r\n          case e: Throwable => logError(s\"Failed to close SparkContext: $e\")\r\n        }\r\n      }\r\n    }\r\n```\r\n\r\nSo here for normal job, I think we should pass the exit code to SchedulerBackend, right?\r\n\r\n\r\nThen after your mention, I see that https://github.com/apache/spark/pull/33403 change the behavior that only k8s call `sc.stop()`, then I think for k8s and yarn mode we booth need to pass the exit code the backend.\r\n\r\nAfter this pr, we also need to check if k8s backend exit code is same as client side in client mode too.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459223471/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459834474",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1459834474",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1459834474,
    "node_id": "IC_kwDOAQXtWs5XA05q",
    "user": {
      "login": "cloud-fan",
      "id": 3182036,
      "node_id": "MDQ6VXNlcjMxODIwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3182036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cloud-fan",
      "html_url": "https://github.com/cloud-fan",
      "followers_url": "https://api.github.com/users/cloud-fan/followers",
      "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}",
      "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions",
      "organizations_url": "https://api.github.com/users/cloud-fan/orgs",
      "repos_url": "https://api.github.com/users/cloud-fan/repos",
      "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cloud-fan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T09:20:49Z",
    "updated_at": "2023-03-08T09:20:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Does YARN still have this issue with Spark 3.4?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459834474/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1460653478",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1460653478",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1460653478,
    "node_id": "IC_kwDOAQXtWs5XD82m",
    "user": {
      "login": "dongjoon-hyun",
      "id": 9700541,
      "node_id": "MDQ6VXNlcjk3MDA1NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9700541?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongjoon-hyun",
      "html_url": "https://github.com/dongjoon-hyun",
      "followers_url": "https://api.github.com/users/dongjoon-hyun/followers",
      "following_url": "https://api.github.com/users/dongjoon-hyun/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongjoon-hyun/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongjoon-hyun/subscriptions",
      "organizations_url": "https://api.github.com/users/dongjoon-hyun/orgs",
      "repos_url": "https://api.github.com/users/dongjoon-hyun/repos",
      "events_url": "https://api.github.com/users/dongjoon-hyun/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongjoon-hyun/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T18:25:14Z",
    "updated_at": "2023-03-08T18:25:14Z",
    "author_association": "MEMBER",
    "body": "cc @mridulm and @tgravescs , too",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1460653478/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1461250566",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1461250566",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1461250566,
    "node_id": "IC_kwDOAQXtWs5XGOoG",
    "user": {
      "login": "AngersZhuuuu",
      "id": 46485123,
      "node_id": "MDQ6VXNlcjQ2NDg1MTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/46485123?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AngersZhuuuu",
      "html_url": "https://github.com/AngersZhuuuu",
      "followers_url": "https://api.github.com/users/AngersZhuuuu/followers",
      "following_url": "https://api.github.com/users/AngersZhuuuu/following{/other_user}",
      "gists_url": "https://api.github.com/users/AngersZhuuuu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AngersZhuuuu/subscriptions",
      "organizations_url": "https://api.github.com/users/AngersZhuuuu/orgs",
      "repos_url": "https://api.github.com/users/AngersZhuuuu/repos",
      "events_url": "https://api.github.com/users/AngersZhuuuu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AngersZhuuuu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-09T04:12:30Z",
    "updated_at": "2023-03-09T04:12:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Does YARN still have this issue with Spark 3.4?\r\n\r\nDidn't see such fix in current code.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1461250566/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1463331316",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1463331316",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1463331316,
    "node_id": "IC_kwDOAQXtWs5XOKn0",
    "user": {
      "login": "cloud-fan",
      "id": 3182036,
      "node_id": "MDQ6VXNlcjMxODIwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3182036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cloud-fan",
      "html_url": "https://github.com/cloud-fan",
      "followers_url": "https://api.github.com/users/cloud-fan/followers",
      "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}",
      "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions",
      "organizations_url": "https://api.github.com/users/cloud-fan/orgs",
      "repos_url": "https://api.github.com/users/cloud-fan/repos",
      "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cloud-fan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-10T06:20:17Z",
    "updated_at": "2023-03-10T06:20:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "This seems to be a revert of https://github.com/apache/spark/pull/33403 as now we stop SparkContext in YARN environment as well. We should justify it in the PR description. This is not simply passing the exitCode. Please update the PR title as well.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1463331316/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1463340552",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1463340552",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1463340552,
    "node_id": "IC_kwDOAQXtWs5XOM4I",
    "user": {
      "login": "AngersZhuuuu",
      "id": 46485123,
      "node_id": "MDQ6VXNlcjQ2NDg1MTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/46485123?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AngersZhuuuu",
      "html_url": "https://github.com/AngersZhuuuu",
      "followers_url": "https://api.github.com/users/AngersZhuuuu/followers",
      "following_url": "https://api.github.com/users/AngersZhuuuu/following{/other_user}",
      "gists_url": "https://api.github.com/users/AngersZhuuuu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AngersZhuuuu/subscriptions",
      "organizations_url": "https://api.github.com/users/AngersZhuuuu/orgs",
      "repos_url": "https://api.github.com/users/AngersZhuuuu/repos",
      "events_url": "https://api.github.com/users/AngersZhuuuu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AngersZhuuuu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-10T06:33:57Z",
    "updated_at": "2023-03-10T06:33:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "> This seems to be a revert of #33403 as now we stop SparkContext in YARN environment as well. We should justify it in the PR description. This is not simply passing the exitCode. Please update the PR title as well.\r\n\r\nDOne",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1463340552/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1463378857",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1463378857",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1463378857,
    "node_id": "IC_kwDOAQXtWs5XOWOp",
    "user": {
      "login": "cloud-fan",
      "id": 3182036,
      "node_id": "MDQ6VXNlcjMxODIwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3182036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cloud-fan",
      "html_url": "https://github.com/cloud-fan",
      "followers_url": "https://api.github.com/users/cloud-fan/followers",
      "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}",
      "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions",
      "organizations_url": "https://api.github.com/users/cloud-fan/orgs",
      "repos_url": "https://api.github.com/users/cloud-fan/repos",
      "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cloud-fan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-10T07:19:43Z",
    "updated_at": "2023-03-10T07:19:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dongjoon-hyun do you have more context about https://github.com/apache/spark/pull/33403? Why do we limit the stopping spark context behavior to k8s only?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1463378857/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1463389076",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1463389076",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1463389076,
    "node_id": "IC_kwDOAQXtWs5XOYuU",
    "user": {
      "login": "AngersZhuuuu",
      "id": 46485123,
      "node_id": "MDQ6VXNlcjQ2NDg1MTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/46485123?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AngersZhuuuu",
      "html_url": "https://github.com/AngersZhuuuu",
      "followers_url": "https://api.github.com/users/AngersZhuuuu/followers",
      "following_url": "https://api.github.com/users/AngersZhuuuu/following{/other_user}",
      "gists_url": "https://api.github.com/users/AngersZhuuuu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AngersZhuuuu/subscriptions",
      "organizations_url": "https://api.github.com/users/AngersZhuuuu/orgs",
      "repos_url": "https://api.github.com/users/AngersZhuuuu/repos",
      "events_url": "https://api.github.com/users/AngersZhuuuu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AngersZhuuuu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-10T07:31:25Z",
    "updated_at": "2023-03-10T07:31:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "Failed UT should not related to this pr.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1463389076/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1463391491",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1463391491",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1463391491,
    "node_id": "IC_kwDOAQXtWs5XOZUD",
    "user": {
      "login": "AngersZhuuuu",
      "id": 46485123,
      "node_id": "MDQ6VXNlcjQ2NDg1MTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/46485123?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AngersZhuuuu",
      "html_url": "https://github.com/AngersZhuuuu",
      "followers_url": "https://api.github.com/users/AngersZhuuuu/followers",
      "following_url": "https://api.github.com/users/AngersZhuuuu/following{/other_user}",
      "gists_url": "https://api.github.com/users/AngersZhuuuu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AngersZhuuuu/subscriptions",
      "organizations_url": "https://api.github.com/users/AngersZhuuuu/orgs",
      "repos_url": "https://api.github.com/users/AngersZhuuuu/repos",
      "events_url": "https://api.github.com/users/AngersZhuuuu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AngersZhuuuu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-10T07:34:09Z",
    "updated_at": "2023-03-10T07:34:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "@cloud-fan Seems this code https://github.com/apache/spark/pull/32283 first want to fix issue in k8s, then @dongjoon-hyun make it limit in k8s env. But this also can work for yarn env....",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1463391491/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1464153355",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1464153355",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1464153355,
    "node_id": "IC_kwDOAQXtWs5XRTUL",
    "user": {
      "login": "dongjoon-hyun",
      "id": 9700541,
      "node_id": "MDQ6VXNlcjk3MDA1NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9700541?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongjoon-hyun",
      "html_url": "https://github.com/dongjoon-hyun",
      "followers_url": "https://api.github.com/users/dongjoon-hyun/followers",
      "following_url": "https://api.github.com/users/dongjoon-hyun/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongjoon-hyun/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongjoon-hyun/subscriptions",
      "organizations_url": "https://api.github.com/users/dongjoon-hyun/orgs",
      "repos_url": "https://api.github.com/users/dongjoon-hyun/repos",
      "events_url": "https://api.github.com/users/dongjoon-hyun/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongjoon-hyun/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-10T17:45:56Z",
    "updated_at": "2023-03-10T17:45:56Z",
    "author_association": "MEMBER",
    "body": "To @cloud-fan and all. Here is the full context.\r\n\r\n- #32081 was the initial commit.\r\n- The initial commit was reverted via ed3f103ee8 due to Hive Thrift Server failure, https://github.com/apache/spark/pull/32081#issuecomment-816399871 .\r\n- The second commit of SPARK-34674 excludes all `Shell` and `STS` environments to avoid the UT failures.\r\n\r\nThree months later after merging the second commit, there was a post-commit review.\r\n- https://github.com/apache/spark/pull/32283#discussion_r670881700\r\n\r\n    ![Screenshot 2023-03-10 at 9 42 04 AM](https://user-images.githubusercontent.com/9700541/224386302-ba1780ab-8be3-461f-aa7d-01a58d964df8.png)\r\n\r\nSince SPARK-34674 was released already to Spark 3.1.2, according to the post-commit comment, I made a new JIRA, SPARK-36193 (#33403) which was released as 3.1.3.\r\n- [SPARK-36193][CORE] Recover SparkSubmit.runMain not to stop SparkContext in non-K8s env",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1464153355/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1465541487",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1465541487",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1465541487,
    "node_id": "IC_kwDOAQXtWs5XWmNv",
    "user": {
      "login": "cloud-fan",
      "id": 3182036,
      "node_id": "MDQ6VXNlcjMxODIwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3182036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cloud-fan",
      "html_url": "https://github.com/cloud-fan",
      "followers_url": "https://api.github.com/users/cloud-fan/followers",
      "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}",
      "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions",
      "organizations_url": "https://api.github.com/users/cloud-fan/orgs",
      "repos_url": "https://api.github.com/users/cloud-fan/repos",
      "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cloud-fan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-13T05:33:49Z",
    "updated_at": "2023-03-13T05:33:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "@AngersZhuuuu can you comment on the original discussion thread and convince related people to add back `sc.stop`? https://github.com/apache/spark/pull/32081#discussion_r663434289",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1465541487/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1465695376",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1465695376",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1465695376,
    "node_id": "IC_kwDOAQXtWs5XXLyQ",
    "user": {
      "login": "AngersZhuuuu",
      "id": 46485123,
      "node_id": "MDQ6VXNlcjQ2NDg1MTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/46485123?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AngersZhuuuu",
      "html_url": "https://github.com/AngersZhuuuu",
      "followers_url": "https://api.github.com/users/AngersZhuuuu/followers",
      "following_url": "https://api.github.com/users/AngersZhuuuu/following{/other_user}",
      "gists_url": "https://api.github.com/users/AngersZhuuuu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AngersZhuuuu/subscriptions",
      "organizations_url": "https://api.github.com/users/AngersZhuuuu/orgs",
      "repos_url": "https://api.github.com/users/AngersZhuuuu/repos",
      "events_url": "https://api.github.com/users/AngersZhuuuu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AngersZhuuuu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-13T08:19:35Z",
    "updated_at": "2023-03-13T08:19:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @AngersZhuuuu can you comment on the original discussion thread and convince related people to add back `sc.stop`? [#32081 (comment)](https://github.com/apache/spark/pull/32081#discussion_r663434289)\r\n\r\nTBH, you can think it as a new feature, since they first just want to only support k8s, and this pr support yarn too",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1465695376/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1465701863",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1465701863",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1465701863,
    "node_id": "IC_kwDOAQXtWs5XXNXn",
    "user": {
      "login": "cloud-fan",
      "id": 3182036,
      "node_id": "MDQ6VXNlcjMxODIwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3182036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cloud-fan",
      "html_url": "https://github.com/cloud-fan",
      "followers_url": "https://api.github.com/users/cloud-fan/followers",
      "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}",
      "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions",
      "organizations_url": "https://api.github.com/users/cloud-fan/orgs",
      "repos_url": "https://api.github.com/users/cloud-fan/repos",
      "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cloud-fan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-13T08:25:04Z",
    "updated_at": "2023-03-13T08:25:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "I believe people in that discussion thread have the most context (some of them are committers) and I'm not comfortable merging it without them taking a look.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1465701863/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1500073974",
    "html_url": "https://github.com/apache/spark/pull/40314#issuecomment-1500073974",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40314",
    "id": 1500073974,
    "node_id": "IC_kwDOAQXtWs5ZaU_2",
    "user": {
      "login": "AngersZhuuuu",
      "id": 46485123,
      "node_id": "MDQ6VXNlcjQ2NDg1MTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/46485123?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AngersZhuuuu",
      "html_url": "https://github.com/AngersZhuuuu",
      "followers_url": "https://api.github.com/users/AngersZhuuuu/followers",
      "following_url": "https://api.github.com/users/AngersZhuuuu/following{/other_user}",
      "gists_url": "https://api.github.com/users/AngersZhuuuu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AngersZhuuuu/subscriptions",
      "organizations_url": "https://api.github.com/users/AngersZhuuuu/orgs",
      "repos_url": "https://api.github.com/users/AngersZhuuuu/repos",
      "events_url": "https://api.github.com/users/AngersZhuuuu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AngersZhuuuu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-07T08:36:50Z",
    "updated_at": "2023-04-07T08:36:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "ping @dongjoon-hyun @HyukjinKwon @attilapiros @srowen ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1500073974/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
