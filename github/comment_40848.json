[
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1514575012",
    "html_url": "https://github.com/apache/spark/pull/40848#issuecomment-1514575012",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40848",
    "id": 1514575012,
    "node_id": "IC_kwDOAQXtWs5aRpSk",
    "user": {
      "login": "pan3793",
      "id": 26535726,
      "node_id": "MDQ6VXNlcjI2NTM1NzI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/26535726?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pan3793",
      "html_url": "https://github.com/pan3793",
      "followers_url": "https://api.github.com/users/pan3793/followers",
      "following_url": "https://api.github.com/users/pan3793/following{/other_user}",
      "gists_url": "https://api.github.com/users/pan3793/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pan3793/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pan3793/subscriptions",
      "organizations_url": "https://api.github.com/users/pan3793/orgs",
      "repos_url": "https://api.github.com/users/pan3793/repos",
      "events_url": "https://api.github.com/users/pan3793/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pan3793/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-19T11:33:22Z",
    "updated_at": "2023-04-19T11:33:22Z",
    "author_association": "MEMBER",
    "body": "cc @sunchao @LuciferYang ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1514575012/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1515104782",
    "html_url": "https://github.com/apache/spark/pull/40848#issuecomment-1515104782",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40848",
    "id": 1515104782,
    "node_id": "IC_kwDOAQXtWs5aTqoO",
    "user": {
      "login": "sunchao",
      "id": 506679,
      "node_id": "MDQ6VXNlcjUwNjY3OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/506679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunchao",
      "html_url": "https://github.com/sunchao",
      "followers_url": "https://api.github.com/users/sunchao/followers",
      "following_url": "https://api.github.com/users/sunchao/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunchao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunchao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunchao/subscriptions",
      "organizations_url": "https://api.github.com/users/sunchao/orgs",
      "repos_url": "https://api.github.com/users/sunchao/repos",
      "events_url": "https://api.github.com/users/sunchao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunchao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-19T17:26:09Z",
    "updated_at": "2023-04-19T17:26:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "Merged to master, thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1515104782/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1558856186",
    "html_url": "https://github.com/apache/spark/pull/40848#issuecomment-1558856186",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40848",
    "id": 1558856186,
    "node_id": "IC_kwDOAQXtWs5c6kH6",
    "user": {
      "login": "LuciferYang",
      "id": 1475305,
      "node_id": "MDQ6VXNlcjE0NzUzMDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1475305?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LuciferYang",
      "html_url": "https://github.com/LuciferYang",
      "followers_url": "https://api.github.com/users/LuciferYang/followers",
      "following_url": "https://api.github.com/users/LuciferYang/following{/other_user}",
      "gists_url": "https://api.github.com/users/LuciferYang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LuciferYang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LuciferYang/subscriptions",
      "organizations_url": "https://api.github.com/users/LuciferYang/orgs",
      "repos_url": "https://api.github.com/users/LuciferYang/repos",
      "events_url": "https://api.github.com/users/LuciferYang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LuciferYang/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-23T09:01:51Z",
    "updated_at": "2023-05-23T09:01:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "@pan3793 I found an interesting thing, after this one merged, when I run the following commands:\r\n\r\n```\r\nbuild/mvn clean install -DskipTests\r\nbuild/mvn test -pl connector/connect/client/jvm -Dtest=none -DwildcardSuites=org.apache.spark.sql.ClientE2ETestSuite\r\n```\r\n\r\nthere are 4 test failed as following:\r\n\r\n```\r\n- read and write *** FAILED ***\r\n  io.grpc.StatusRuntimeException: INTERNAL: org.apache.spark.sql.sources.DataSourceRegister: Provider org.apache.spark.sql.hive.execution.HiveFileFormat could not be instantiated\r\n  at io.grpc.Status.asRuntimeException(Status.java:535)\r\n  at io.grpc.stub.ClientCalls$BlockingResponseStream.hasNext(ClientCalls.java:660)\r\n  at scala.collection.convert.Wrappers$JIteratorWrapper.hasNext(Wrappers.scala:45)\r\n  at scala.collection.Iterator.foreach(Iterator.scala:943)\r\n  at scala.collection.Iterator.foreach$(Iterator.scala:943)\r\n  at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\r\n  at org.apache.spark.sql.SparkSession.execute(SparkSession.scala:458)\r\n  at org.apache.spark.sql.DataFrameWriter.executeWriteOperation(DataFrameWriter.scala:257)\r\n  at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:221)\r\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:210)\r\n  ...\r\n- textFile *** FAILED ***\r\n  io.grpc.StatusRuntimeException: INTERNAL: org.apache.spark.sql.sources.DataSourceRegister: Provider org.apache.spark.sql.hive.execution.HiveFileFormat could not be instantiated\r\n  at io.grpc.Status.asRuntimeException(Status.java:535)\r\n  at io.grpc.stub.ClientCalls$BlockingResponseStream.hasNext(ClientCalls.java:660)\r\n  at org.apache.spark.sql.connect.client.SparkResult.org$apache$spark$sql$connect$client$SparkResult$$processResponses(SparkResult.scala:62)\r\n  at org.apache.spark.sql.connect.client.SparkResult.length(SparkResult.scala:114)\r\n  at org.apache.spark.sql.connect.client.SparkResult.toArray(SparkResult.scala:131)\r\n  at org.apache.spark.sql.Dataset.$anonfun$collect$1(Dataset.scala:2688)\r\n  at org.apache.spark.sql.Dataset.withResult(Dataset.scala:3128)\r\n  at org.apache.spark.sql.Dataset.collect(Dataset.scala:2687)\r\n  at org.apache.spark.sql.ClientE2ETestSuite.$anonfun$new$12(ClientE2ETestSuite.scala:169)\r\n  at org.scalatest.OutcomeOf.outcomeOf(OutcomeOf.scala:85)\r\n  ...\r\n- write table *** FAILED ***\r\n  io.grpc.StatusRuntimeException: INTERNAL: org.apache.spark.sql.sources.DataSourceRegister: Provider org.apache.spark.sql.hive.execution.HiveFileFormat could not be instantiated\r\n  at io.grpc.Status.asRuntimeException(Status.java:535)\r\n  at io.grpc.stub.ClientCalls$BlockingResponseStream.hasNext(ClientCalls.java:660)\r\n  at scala.collection.convert.Wrappers$JIteratorWrapper.hasNext(Wrappers.scala:45)\r\n  at scala.collection.Iterator.toStream(Iterator.scala:1417)\r\n  at scala.collection.Iterator.toStream$(Iterator.scala:1416)\r\n  at scala.collection.AbstractIterator.toStream(Iterator.scala:1431)\r\n  at scala.collection.TraversableOnce.toSeq(TraversableOnce.scala:354)\r\n  at scala.collection.TraversableOnce.toSeq$(TraversableOnce.scala:354)\r\n  at scala.collection.AbstractIterator.toSeq(Iterator.scala:1431)\r\n  at org.apache.spark.sql.SparkSession.execute(SparkSession.scala:471)\r\n  ...\r\n- write without table or path *** FAILED ***\r\n  io.grpc.StatusRuntimeException: INTERNAL: org.apache.spark.sql.sources.DataSourceRegister: Provider org.apache.spark.sql.hive.execution.HiveFileFormat could not be instantiated\r\n  at io.grpc.Status.asRuntimeException(Status.java:535)\r\n  at io.grpc.stub.ClientCalls$BlockingResponseStream.hasNext(ClientCalls.java:660)\r\n  at scala.collection.convert.Wrappers$JIteratorWrapper.hasNext(Wrappers.scala:45)\r\n  at scala.collection.Iterator.toStream(Iterator.scala:1417)\r\n  at scala.collection.Iterator.toStream$(Iterator.scala:1416)\r\n  at scala.collection.AbstractIterator.toStream(Iterator.scala:1431)\r\n  at scala.collection.TraversableOnce.toSeq(TraversableOnce.scala:354)\r\n  at scala.collection.TraversableOnce.toSeq$(TraversableOnce.scala:354)\r\n  at scala.collection.AbstractIterator.toSeq(Iterator.scala:1431)\r\n  at org.apache.spark.sql.SparkSession.execute(SparkSession.scala:471)\r\n  ...\r\n```\r\n\r\nbut  if I revert this one, the the failure will disappear. `CatalogSuite` and `StreamingQuerySuite` also has some problems.Already created [SPARK-43647](https://issues.apache.org/jira/browse/SPARK-43647) to tracking this, Do you have time to investigate togethe?\r\n\r\n ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1558856186/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1558953872",
    "html_url": "https://github.com/apache/spark/pull/40848#issuecomment-1558953872",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40848",
    "id": 1558953872,
    "node_id": "IC_kwDOAQXtWs5c67-Q",
    "user": {
      "login": "pan3793",
      "id": 26535726,
      "node_id": "MDQ6VXNlcjI2NTM1NzI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/26535726?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pan3793",
      "html_url": "https://github.com/pan3793",
      "followers_url": "https://api.github.com/users/pan3793/followers",
      "following_url": "https://api.github.com/users/pan3793/following{/other_user}",
      "gists_url": "https://api.github.com/users/pan3793/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pan3793/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pan3793/subscriptions",
      "organizations_url": "https://api.github.com/users/pan3793/orgs",
      "repos_url": "https://api.github.com/users/pan3793/repos",
      "events_url": "https://api.github.com/users/pan3793/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pan3793/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-23T09:58:56Z",
    "updated_at": "2023-05-23T09:58:56Z",
    "author_association": "MEMBER",
    "body": "Tests pass if enable `-Phive`\r\n\r\n```\r\nbuild/mvn clean install -DskipTests -Phive\r\nbuild/mvn test -pl connector/connect/client/jvm -Dtest=none -DwildcardSuites=org.apache.spark.sql.ClientE2ETestSuite\r\n```\r\n\r\nSeems reasonable",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1558953872/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1559065577",
    "html_url": "https://github.com/apache/spark/pull/40848#issuecomment-1559065577",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40848",
    "id": 1559065577,
    "node_id": "IC_kwDOAQXtWs5c7XPp",
    "user": {
      "login": "LuciferYang",
      "id": 1475305,
      "node_id": "MDQ6VXNlcjE0NzUzMDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1475305?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LuciferYang",
      "html_url": "https://github.com/LuciferYang",
      "followers_url": "https://api.github.com/users/LuciferYang/followers",
      "following_url": "https://api.github.com/users/LuciferYang/following{/other_user}",
      "gists_url": "https://api.github.com/users/LuciferYang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LuciferYang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LuciferYang/subscriptions",
      "organizations_url": "https://api.github.com/users/LuciferYang/orgs",
      "repos_url": "https://api.github.com/users/LuciferYang/repos",
      "events_url": "https://api.github.com/users/LuciferYang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LuciferYang/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-23T11:01:57Z",
    "updated_at": "2023-05-23T11:01:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Tests pass if enable `-Phive`\r\n> \r\n> ```\r\n> build/mvn clean install -DskipTests -Phive\r\n> build/mvn test -pl connector/connect/client/jvm -Dtest=none -DwildcardSuites=org.apache.spark.sql.ClientE2ETestSuite\r\n> ```\r\n> \r\n> Seems reasonable\r\n\r\nNo, these test can passed without -Phive without this pr",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1559065577/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1559067577",
    "html_url": "https://github.com/apache/spark/pull/40848#issuecomment-1559067577",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40848",
    "id": 1559067577,
    "node_id": "IC_kwDOAQXtWs5c7Xu5",
    "user": {
      "login": "LuciferYang",
      "id": 1475305,
      "node_id": "MDQ6VXNlcjE0NzUzMDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1475305?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LuciferYang",
      "html_url": "https://github.com/LuciferYang",
      "followers_url": "https://api.github.com/users/LuciferYang/followers",
      "following_url": "https://api.github.com/users/LuciferYang/following{/other_user}",
      "gists_url": "https://api.github.com/users/LuciferYang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LuciferYang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LuciferYang/subscriptions",
      "organizations_url": "https://api.github.com/users/LuciferYang/orgs",
      "repos_url": "https://api.github.com/users/LuciferYang/repos",
      "events_url": "https://api.github.com/users/LuciferYang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LuciferYang/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-23T11:03:24Z",
    "updated_at": "2023-05-23T11:03:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "The error stack in server side as follows:\r\n\r\n```\r\njava.util.ServiceConfigurationError: org.apache.spark.sql.sources.DataSourceRegister: Provider org.apache.spark.sql.hive.execution.HiveFileFormat could not be instantiated\r\n\tat java.util.ServiceLoader.fail(ServiceLoader.java:232)\r\n\tat java.util.ServiceLoader.access$100(ServiceLoader.java:185)\r\n\tat java.util.ServiceLoader$LazyIterator.nextService(ServiceLoader.java:384)\r\n\tat java.util.ServiceLoader$LazyIterator.next(ServiceLoader.java:404)\r\n\tat java.util.ServiceLoader$1.next(ServiceLoader.java:480)\r\n\tat scala.collection.convert.Wrappers$JIteratorWrapper.next(Wrappers.scala:46)\r\n\tat scala.collection.Iterator.foreach(Iterator.scala:943)\r\n\tat scala.collection.Iterator.foreach$(Iterator.scala:943)\r\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\r\n\tat scala.collection.IterableLike.foreach(IterableLike.scala:74)\r\n\tat scala.collection.IterableLike.foreach$(IterableLike.scala:73)\r\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:56)\r\n\tat scala.collection.TraversableLike.filterImpl(TraversableLike.scala:303)\r\n\tat scala.collection.TraversableLike.filterImpl$(TraversableLike.scala:297)\r\n\tat scala.collection.AbstractTraversable.filterImpl(Traversable.scala:108)\r\n\tat scala.collection.TraversableLike.filter(TraversableLike.scala:395)\r\n\tat scala.collection.TraversableLike.filter$(TraversableLike.scala:395)\r\n\tat scala.collection.AbstractTraversable.filter(Traversable.scala:108)\r\n\tat org.apache.spark.sql.execution.datasources.DataSource$.lookupDataSource(DataSource.scala:629)\r\n\tat org.apache.spark.sql.execution.datasources.DataSource$.lookupDataSourceV2(DataSource.scala:697)\r\n\tat org.apache.spark.sql.DataFrameWriter.lookupV2Provider(DataFrameWriter.scala:860)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:256)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:239)\r\n\tat org.apache.spark.sql.connect.planner.SparkConnectPlanner.handleWriteOperation(SparkConnectPlanner.scala:2321)\r\n\tat org.apache.spark.sql.connect.planner.SparkConnectPlanner.process(SparkConnectPlanner.scala:2091)\r\n\tat org.apache.spark.sql.connect.service.SparkConnectStreamHandler.handleCommand(SparkConnectStreamHandler.scala:120)\r\n\tat org.apache.spark.sql.connect.service.SparkConnectStreamHandler.$anonfun$handle$2(SparkConnectStreamHandler.scala:86)\r\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:825)\r\n\tat org.apache.spark.sql.connect.service.SparkConnectStreamHandler.$anonfun$handle$1(SparkConnectStreamHandler.scala:53)\r\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\r\n\tat org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:209)\r\n\tat org.apache.spark.sql.connect.artifact.SparkConnectArtifactManager$.withArtifactClassLoader(SparkConnectArtifactManager.scala:178)\r\n\tat org.apache.spark.sql.connect.service.SparkConnectStreamHandler.handle(SparkConnectStreamHandler.scala:48)\r\n\tat org.apache.spark.sql.connect.service.SparkConnectService.executePlan(SparkConnectService.scala:166)\r\n\tat org.apache.spark.connect.proto.SparkConnectServiceGrpc$MethodHandlers.invoke(SparkConnectServiceGrpc.java:611)\r\n\tat org.sparkproject.connect.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\r\n\tat org.sparkproject.connect.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:352)\r\n\tat org.sparkproject.connect.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:866)\r\n\tat org.sparkproject.connect.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\r\n\tat org.sparkproject.connect.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\nCaused by: java.lang.NoClassDefFoundError: org/apache/hadoop/hive/ql/plan/FileSinkDesc\r\n\tat java.lang.Class.getDeclaredConstructors0(Native Method)\r\n\tat java.lang.Class.privateGetDeclaredConstructors(Class.java:2671)\r\n\tat java.lang.Class.getConstructor0(Class.java:3075)\r\n\tat java.lang.Class.newInstance(Class.java:412)\r\n\tat java.util.ServiceLoader$LazyIterator.nextService(ServiceLoader.java:380)\r\n\t... 41 more\r\nCaused by: java.lang.ClassNotFoundException: org.apache.hadoop.hive.ql.plan.FileSinkDesc\r\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:387)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:419)\r\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:352)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:352)\r\n\t... 46 more\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1559067577/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
