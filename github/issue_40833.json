{
  "url": "https://api.github.com/repos/apache/spark/issues/40833",
  "repository_url": "https://api.github.com/repos/apache/spark",
  "labels_url": "https://api.github.com/repos/apache/spark/issues/40833/labels{/name}",
  "comments_url": "https://api.github.com/repos/apache/spark/issues/40833/comments",
  "events_url": "https://api.github.com/repos/apache/spark/issues/40833/events",
  "html_url": "https://github.com/apache/spark/pull/40833",
  "id": 1672390181,
  "node_id": "PR_kwDOAQXtWs5Oio2p",
  "number": 40833,
  "title": "[SPARK-43137][SQL] Improve ArrayInsert if the position is foldable and positive.",
  "user": {
    "login": "beliefer",
    "id": 8486025,
    "node_id": "MDQ6VXNlcjg0ODYwMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8486025?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/beliefer",
    "html_url": "https://github.com/beliefer",
    "followers_url": "https://api.github.com/users/beliefer/followers",
    "following_url": "https://api.github.com/users/beliefer/following{/other_user}",
    "gists_url": "https://api.github.com/users/beliefer/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/beliefer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/beliefer/subscriptions",
    "organizations_url": "https://api.github.com/users/beliefer/orgs",
    "repos_url": "https://api.github.com/users/beliefer/repos",
    "events_url": "https://api.github.com/users/beliefer/events{/privacy}",
    "received_events_url": "https://api.github.com/users/beliefer/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1405794576,
      "node_id": "MDU6TGFiZWwxNDA1Nzk0NTc2",
      "url": "https://api.github.com/repos/apache/spark/labels/SQL",
      "name": "SQL",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-04-18T05:43:58Z",
  "updated_at": "2023-04-20T02:53:33Z",
  "closed_at": "2023-04-19T14:12:35Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/apache/spark/pulls/40833",
    "html_url": "https://github.com/apache/spark/pull/40833",
    "diff_url": "https://github.com/apache/spark/pull/40833.diff",
    "patch_url": "https://github.com/apache/spark/pull/40833.patch",
    "merged_at": null
  },
  "body": "### What changes were proposed in this pull request?\r\nCurrently, Spark supports the `array_insert` and `array_prepend`. Users insert an element into the head of array is common operation. Considered, we want make array_prepend reuse the implementation of array_insert, but it seems a bit performance worse if the position is foldable and positive.\r\nThe reason is that always do the check for position is negative or positive, and the code is too long. Too long code will lead to JIT failed.\r\n\r\n\r\n### Why are the changes needed?\r\nImprove ArrayInsert if the position is foldable and positive.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n'No'.\r\nJust change the inner implementation.\r\n\r\n\r\n### How was this patch tested?\r\nExists test cases.\r\n",
  "closed_by": {
    "login": "cloud-fan",
    "id": 3182036,
    "node_id": "MDQ6VXNlcjMxODIwMzY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3182036?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cloud-fan",
    "html_url": "https://github.com/cloud-fan",
    "followers_url": "https://api.github.com/users/cloud-fan/followers",
    "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}",
    "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions",
    "organizations_url": "https://api.github.com/users/cloud-fan/orgs",
    "repos_url": "https://api.github.com/users/cloud-fan/repos",
    "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cloud-fan/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/apache/spark/issues/40833/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/apache/spark/issues/40833/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
