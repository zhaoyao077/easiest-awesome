{
  "url": "https://api.github.com/repos/apache/spark/issues/41122",
  "repository_url": "https://api.github.com/repos/apache/spark",
  "labels_url": "https://api.github.com/repos/apache/spark/issues/41122/labels{/name}",
  "comments_url": "https://api.github.com/repos/apache/spark/issues/41122/comments",
  "events_url": "https://api.github.com/repos/apache/spark/issues/41122/events",
  "html_url": "https://github.com/apache/spark/pull/41122",
  "id": 1704249010,
  "node_id": "PR_kwDOAQXtWs5QNe4T",
  "number": 41122,
  "title": "[SPARK-43436][BUILD] Upgrade rocksdbjni to 8.1.1.1",
  "user": {
    "login": "LuciferYang",
    "id": 1475305,
    "node_id": "MDQ6VXNlcjE0NzUzMDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1475305?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/LuciferYang",
    "html_url": "https://github.com/LuciferYang",
    "followers_url": "https://api.github.com/users/LuciferYang/followers",
    "following_url": "https://api.github.com/users/LuciferYang/following{/other_user}",
    "gists_url": "https://api.github.com/users/LuciferYang/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/LuciferYang/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/LuciferYang/subscriptions",
    "organizations_url": "https://api.github.com/users/LuciferYang/orgs",
    "repos_url": "https://api.github.com/users/LuciferYang/repos",
    "events_url": "https://api.github.com/users/LuciferYang/events{/privacy}",
    "received_events_url": "https://api.github.com/users/LuciferYang/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1405794576,
      "node_id": "MDU6TGFiZWwxNDA1Nzk0NTc2",
      "url": "https://api.github.com/repos/apache/spark/labels/SQL",
      "name": "SQL",
      "color": "ededed",
      "default": false,
      "description": null
    },
    {
      "id": 1406627200,
      "node_id": "MDU6TGFiZWwxNDA2NjI3MjAw",
      "url": "https://api.github.com/repos/apache/spark/labels/BUILD",
      "name": "BUILD",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2023-05-10T16:09:33Z",
  "updated_at": "2023-05-17T20:30:48Z",
  "closed_at": "2023-05-17T20:30:40Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/apache/spark/pulls/41122",
    "html_url": "https://github.com/apache/spark/pull/41122",
    "diff_url": "https://github.com/apache/spark/pull/41122.diff",
    "patch_url": "https://github.com/apache/spark/pull/41122.patch",
    "merged_at": null
  },
  "body": "### What changes were proposed in this pull request?\r\nThis pr aims to upgrade rocksdbjni from 8.0.0 to 8.1.1.1.\r\n\r\n\r\n### Why are the changes needed?\r\nThe full release notes as follows:\r\n\r\n- https://github.com/facebook/rocksdb/releases/tag/v8.1.1\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n\r\n- Pass GitHub Actions\r\n- Manual test `RocksDBBenchmark`:\r\n\r\n**8.0.0**\r\n\r\n```\r\n[INFO] Running org.apache.spark.util.kvstore.RocksDBBenchmark\r\n                                                count   mean    min     max     95th\r\ndbClose                                         4       0.339   0.256   0.532   0.532\r\ndbCreation                                      4       69.637  4.128   268.371 268.371\r\nnaturalIndexCreateIterator                      1024    0.005   0.002   1.581   0.006\r\nnaturalIndexDescendingCreateIterator            1024    0.005   0.005   0.067   0.007\r\nnaturalIndexDescendingIteration                 1024    0.006   0.004   0.029   0.008\r\nnaturalIndexIteration                           1024    0.006   0.004   0.069   0.009\r\nrandomDeleteIndexed                             1024    0.026   0.018   0.200   0.035\r\nrandomDeletesNoIndex                            1024    0.015   0.012   0.050   0.018\r\nrandomUpdatesIndexed                            1024    0.088   0.033   33.234  0.096\r\nrandomUpdatesNoIndex                            1024    0.035   0.032   0.497   0.039\r\nrandomWritesIndexed                             1024    0.129   0.035   56.362  0.121\r\nrandomWritesNoIndex                             1024    0.041   0.034   1.415   0.047\r\nrefIndexCreateIterator                          1024    0.005   0.004   0.029   0.006\r\nrefIndexDescendingCreateIterator                1024    0.003   0.003   0.028   0.004\r\nrefIndexDescendingIteration                     1024    0.007   0.005   0.044   0.008\r\nrefIndexIteration                               1024    0.008   0.005   0.367   0.010\r\nsequentialDeleteIndexed                         1024    0.023   0.017   1.716   0.025\r\nsequentialDeleteNoIndex                         1024    0.015   0.012   0.043   0.017\r\nsequentialUpdatesIndexed                        1024    0.045   0.037   0.943   0.054\r\nsequentialUpdatesNoIndex                        1024    0.041   0.029   0.838   0.053\r\nsequentialWritesIndexed                         1024    0.051   0.043   2.945   0.056\r\nsequentialWritesNoIndex                         1024    0.037   0.030   2.828   0.042\r\n```\r\n\r\n\r\n**8.1.1.1**\r\n\r\n```\r\n[INFO] Running org.apache.spark.util.kvstore.RocksDBBenchmark\r\n                                                count   mean    min     max     95th\r\ndbClose                                         4       0.319   0.233   0.514   0.514\r\ndbCreation                                      4       69.826  3.767   268.894 268.894\r\nnaturalIndexCreateIterator                      1024    0.005   0.002   1.409   0.007\r\nnaturalIndexDescendingCreateIterator            1024    0.005   0.005   0.062   0.007\r\nnaturalIndexDescendingIteration                 1024    0.006   0.004   0.026   0.008\r\nnaturalIndexIteration                           1024    0.007   0.004   0.182   0.011\r\nrandomDeleteIndexed                             1024    0.027   0.020   0.259   0.037\r\nrandomDeletesNoIndex                            1024    0.016   0.013   0.041   0.019\r\nrandomUpdatesIndexed                            1024    0.087   0.033   29.514  0.102\r\nrandomUpdatesNoIndex                            1024    0.036   0.033   0.495   0.040\r\nrandomWritesIndexed                             1024    0.120   0.033   53.330  0.126\r\nrandomWritesNoIndex                             1024    0.041   0.035   1.403   0.047\r\nrefIndexCreateIterator                          1024    0.006   0.005   0.019   0.007\r\nrefIndexDescendingCreateIterator                1024    0.003   0.003   0.028   0.005\r\nrefIndexDescendingIteration                     1024    0.007   0.005   0.053   0.008\r\nrefIndexIteration                               1024    0.008   0.006   0.254   0.010\r\nsequentialDeleteIndexed                         1024    0.023   0.018   1.237   0.027\r\nsequentialDeleteNoIndex                         1024    0.015   0.013   0.043   0.018\r\nsequentialUpdatesIndexed                        1024    0.046   0.038   0.816   0.057\r\nsequentialUpdatesNoIndex                        1024    0.042   0.030   0.719   0.052\r\nsequentialWritesIndexed                         1024    0.050   0.042   2.089   0.057\r\nsequentialWritesNoIndex                         1024    0.036   0.030   2.030   0.042\r\n```\r\n\r\n- Checked core module UTs with rocksdb live ui\r\n\r\n```\r\nexport LIVE_UI_LOCAL_STORE_DIR=/${basedir}/spark-ui    \r\nbuild/mvn clean install -pl core -am -Dtest.exclude.tags=org.apache.spark.tags.ExtendedLevelDBTest -fn\r\n```\r\n\r\nall test passed",
  "closed_by": {
    "login": "dongjoon-hyun",
    "id": 9700541,
    "node_id": "MDQ6VXNlcjk3MDA1NDE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9700541?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dongjoon-hyun",
    "html_url": "https://github.com/dongjoon-hyun",
    "followers_url": "https://api.github.com/users/dongjoon-hyun/followers",
    "following_url": "https://api.github.com/users/dongjoon-hyun/following{/other_user}",
    "gists_url": "https://api.github.com/users/dongjoon-hyun/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dongjoon-hyun/subscriptions",
    "organizations_url": "https://api.github.com/users/dongjoon-hyun/orgs",
    "repos_url": "https://api.github.com/users/dongjoon-hyun/repos",
    "events_url": "https://api.github.com/users/dongjoon-hyun/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dongjoon-hyun/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/apache/spark/issues/41122/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/apache/spark/issues/41122/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
