{
  "url": "https://api.github.com/repos/apache/spark/issues/41021",
  "repository_url": "https://api.github.com/repos/apache/spark",
  "labels_url": "https://api.github.com/repos/apache/spark/issues/41021/labels{/name}",
  "comments_url": "https://api.github.com/repos/apache/spark/issues/41021/comments",
  "events_url": "https://api.github.com/repos/apache/spark/issues/41021/events",
  "html_url": "https://github.com/apache/spark/pull/41021",
  "id": 1693140839,
  "node_id": "PR_kwDOAQXtWs5Pn95J",
  "number": 41021,
  "title": "[SPARK-16484][SQL] Use 8-bit registers for representing DataSketches",
  "user": {
    "login": "mkaravel",
    "id": 6397014,
    "node_id": "MDQ6VXNlcjYzOTcwMTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6397014?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mkaravel",
    "html_url": "https://github.com/mkaravel",
    "followers_url": "https://api.github.com/users/mkaravel/followers",
    "following_url": "https://api.github.com/users/mkaravel/following{/other_user}",
    "gists_url": "https://api.github.com/users/mkaravel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mkaravel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mkaravel/subscriptions",
    "organizations_url": "https://api.github.com/users/mkaravel/orgs",
    "repos_url": "https://api.github.com/users/mkaravel/repos",
    "events_url": "https://api.github.com/users/mkaravel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mkaravel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1405794576,
      "node_id": "MDU6TGFiZWwxNDA1Nzk0NTc2",
      "url": "https://api.github.com/repos/apache/spark/labels/SQL",
      "name": "SQL",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-05-02T21:45:44Z",
  "updated_at": "2023-05-03T08:44:01Z",
  "closed_at": "2023-05-03T08:44:01Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/apache/spark/pulls/41021",
    "html_url": "https://github.com/apache/spark/pull/41021",
    "diff_url": "https://github.com/apache/spark/pull/41021.diff",
    "patch_url": "https://github.com/apache/spark/pull/41021.patch",
    "merged_at": null
  },
  "body": "### What changes were proposed in this pull request?\r\n\r\nThis is a follow-up PR to #40615.\r\n\r\nIn this PR we make sure that all sketches produces by the new expressions `hll_sketch_agg`, `hll_union_agg`, and `hll_union` are actually HLL DataSketches represented with 8-bit registers.\r\n\r\nUsing 8-bit registers improves the performance of the expressions at the expense of using more memory (the current implementation uses 4-bit registers by default, which is the default choice in the DataSketches library).\r\n\r\nNote that the register size of the DataSketches HLL sketch does not have any impact on the accuracy of the sketch.\r\n\r\n### Why are the changes needed?\r\n\r\nTo improve the performance of the new HLL-related expressions.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo in terms of SQL surface. However, the results of the `hll_sketch_agg`, `hll_union_agg`, and `hll_union` expressions can be different since we are changing the sketch representation. However, since these expressions have not been released yet we are not facing any breaking changes.\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests suffice.\r\n",
  "closed_by": {
    "login": "HyukjinKwon",
    "id": 6477701,
    "node_id": "MDQ6VXNlcjY0Nzc3MDE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6477701?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/HyukjinKwon",
    "html_url": "https://github.com/HyukjinKwon",
    "followers_url": "https://api.github.com/users/HyukjinKwon/followers",
    "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}",
    "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions",
    "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs",
    "repos_url": "https://api.github.com/users/HyukjinKwon/repos",
    "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/apache/spark/issues/41021/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/apache/spark/issues/41021/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
