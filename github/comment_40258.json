[
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1453913043",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1453913043",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1453913043,
    "node_id": "IC_kwDOAQXtWs5WqPPT",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T18:14:01Z",
    "updated_at": "2023-03-03T18:15:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "@srowen  Please ignore that change. It was work in progress to check few things. \r\nThe reason why we get ambiguous error in below scenario and why it's not correct is the result of attribute resolution returns  \r\ntwo values but both values are same. Thus, it should not throw ambiguous error.\r\n\r\nval df1 = sc.parallelize(List((1,2,3,4,5),(1,2,3,4,5))).toDF(\"id\",\"col2\",\"col3\",\"col4\", \"col5\")\r\nval op_cols_mixed_case = List(\"id\",\"col2\",\"col3\",\"col4\", \"col5\", \"ID\")\r\nval df3 = df1.select(op_cols_mixed_case.head, op_cols_mixed_case.tail: _*)\r\ndf3.select(\"id\").show()\r\norg.apache.spark.sql.AnalysisException: Reference 'id' is ambiguous, could be: id, id.\r\n\r\ndf3.explain()\r\n== Physical Plan ==\r\n*(1) Project [_1#6 AS id#17, _2#7 AS col2#18, _3#8 AS col3#19, _4#9 AS col4#20, _5#10 AS col5#21, _1#6 AS ID#17]\r\n\r\nBefore the fix, attributes matched were:\r\nattributes: Vector(id#17, id#17)\r\nThus, it throws ambiguous reference error. But if we consider only unique matches, it will return correct result.\r\nunique attributes: Vector(id#17)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1453913043/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1454348175",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1454348175",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1454348175,
    "node_id": "IC_kwDOAQXtWs5Wr5eP",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-04T02:53:44Z",
    "updated_at": "2023-03-04T02:53:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "@srowen @dongjoon-hyun Can you please review this PR?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1454348175/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1457585690",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1457585690",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1457585690,
    "node_id": "IC_kwDOAQXtWs5W4P4a",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T05:56:12Z",
    "updated_at": "2023-03-07T06:38:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "Gentle Ping @srowen  @dongjoon-hyun @mridulm @HyukjinKwon ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1457585690/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1458138622",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1458138622",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1458138622,
    "node_id": "IC_kwDOAQXtWs5W6W3-",
    "user": {
      "login": "srowen",
      "id": 822522,
      "node_id": "MDQ6VXNlcjgyMjUyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/822522?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/srowen",
      "html_url": "https://github.com/srowen",
      "followers_url": "https://api.github.com/users/srowen/followers",
      "following_url": "https://api.github.com/users/srowen/following{/other_user}",
      "gists_url": "https://api.github.com/users/srowen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/srowen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/srowen/subscriptions",
      "organizations_url": "https://api.github.com/users/srowen/orgs",
      "repos_url": "https://api.github.com/users/srowen/repos",
      "events_url": "https://api.github.com/users/srowen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/srowen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T13:06:13Z",
    "updated_at": "2023-03-07T13:06:13Z",
    "author_association": "MEMBER",
    "body": "I'm not sure about the change, not sure I'm qualified to review it. I think at best the error message should change; I am not clear that the result is 'wrong'",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1458138622/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1458159825",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1458159825",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1458159825,
    "node_id": "IC_kwDOAQXtWs5W6cDR",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T13:19:07Z",
    "updated_at": "2023-03-07T13:19:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I'm not sure about the change, not sure I'm qualified to review it. I think at best the error message should change; I am not clear that the result is 'wrong'\r\n\r\nThanks for replying. Can you please tag someone who should be right person to review this change?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1458159825/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459535564",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1459535564",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1459535564,
    "node_id": "IC_kwDOAQXtWs5W_r7M",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T05:25:38Z",
    "updated_at": "2023-03-08T05:25:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "Gentle ping @dongjoon-hyun @mridulm @HyukjinKwon @yaooqinn Can you please review this PR?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459535564/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459648316",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1459648316",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1459648316,
    "node_id": "IC_kwDOAQXtWs5XAHc8",
    "user": {
      "login": "yaooqinn",
      "id": 8326978,
      "node_id": "MDQ6VXNlcjgzMjY5Nzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8326978?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yaooqinn",
      "html_url": "https://github.com/yaooqinn",
      "followers_url": "https://api.github.com/users/yaooqinn/followers",
      "following_url": "https://api.github.com/users/yaooqinn/following{/other_user}",
      "gists_url": "https://api.github.com/users/yaooqinn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yaooqinn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yaooqinn/subscriptions",
      "organizations_url": "https://api.github.com/users/yaooqinn/orgs",
      "repos_url": "https://api.github.com/users/yaooqinn/repos",
      "events_url": "https://api.github.com/users/yaooqinn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yaooqinn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T07:16:10Z",
    "updated_at": "2023-03-08T07:16:10Z",
    "author_association": "MEMBER",
    "body": "Can you try `set spark.sql.caseSensitive=true`?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459648316/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459652942",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1459652942",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1459652942,
    "node_id": "IC_kwDOAQXtWs5XAIlO",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T07:21:34Z",
    "updated_at": "2023-03-08T11:04:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Can you try `set spark.sql.caseSensitive=true`?\r\n\r\nYes, I have tried it. With caseSensitive set to true, it will work as then id and ID will be treated as separate columns.\r\nIssue is when columns names are supposed to considered  as case insensitive.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459652942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459654900",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1459654900",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1459654900,
    "node_id": "IC_kwDOAQXtWs5XAJD0",
    "user": {
      "login": "yaooqinn",
      "id": 8326978,
      "node_id": "MDQ6VXNlcjgzMjY5Nzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8326978?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yaooqinn",
      "html_url": "https://github.com/yaooqinn",
      "followers_url": "https://api.github.com/users/yaooqinn/followers",
      "following_url": "https://api.github.com/users/yaooqinn/following{/other_user}",
      "gists_url": "https://api.github.com/users/yaooqinn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yaooqinn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yaooqinn/subscriptions",
      "organizations_url": "https://api.github.com/users/yaooqinn/orgs",
      "repos_url": "https://api.github.com/users/yaooqinn/repos",
      "events_url": "https://api.github.com/users/yaooqinn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yaooqinn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T07:23:50Z",
    "updated_at": "2023-03-08T07:23:50Z",
    "author_association": "MEMBER",
    "body": "You first defined a case-sensitive data set, then queried in a case-insensitive way, I guess the error is expected.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459654900/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1459668923",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1459668923",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1459668923,
    "node_id": "IC_kwDOAQXtWs5XAMe7",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T07:39:53Z",
    "updated_at": "2023-03-08T07:42:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "> You first defined a case-sensitive data set, then queried in a case-insensitive way, I guess the error is expected.\r\n\r\nIn the physical plan, both id and ID columns are projected to the same column in the dataframe: _1#6\r\n_1#6 AS id#17,  _1#6 AS ID#17\r\nSo, there is no ambiguity,\r\n\r\nAlso, in the matched attributes, results are same: attributes: Vector(id#17, id#17)\r\nJust because, we have duplicates in the matched result, it's being considered as ambiguous.\r\n\r\nIf the matched attribute result was Vector(id#17, ID#17) , then it would have been valid error.\r\n\r\nAnd even if the dataset has columns in different cases, Spark being case insensitive by default, should consider both columns as same.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1459668923/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1460147096",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1460147096",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1460147096,
    "node_id": "IC_kwDOAQXtWs5XCBOY",
    "user": {
      "login": "srowen",
      "id": 822522,
      "node_id": "MDQ6VXNlcjgyMjUyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/822522?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/srowen",
      "html_url": "https://github.com/srowen",
      "followers_url": "https://api.github.com/users/srowen/followers",
      "following_url": "https://api.github.com/users/srowen/following{/other_user}",
      "gists_url": "https://api.github.com/users/srowen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/srowen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/srowen/subscriptions",
      "organizations_url": "https://api.github.com/users/srowen/orgs",
      "repos_url": "https://api.github.com/users/srowen/repos",
      "events_url": "https://api.github.com/users/srowen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/srowen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T13:20:02Z",
    "updated_at": "2023-03-08T13:20:02Z",
    "author_association": "MEMBER",
    "body": "I don't get it, it is due to case sensitivity; that's why it becomes ambiguous and that's what you see. The issue is that the error isn't super helpful because it shows the lower-cased column right? that's what I was saying. Or: does your change still result in an error without case sensitivity? it should",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1460147096/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1461262849",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1461262849",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1461262849,
    "node_id": "IC_kwDOAQXtWs5XGRoB",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-09T04:30:27Z",
    "updated_at": "2023-03-09T04:30:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I don't get it, it is due to case sensitivity; that's why it becomes ambiguous and that's what you see. The issue is that the error isn't super helpful because it shows the lower-cased column right? that's what I was saying. Or: does your change still result in an error without case sensitivity? it should\r\n\r\nThe issue is not with the error message. Problem is that in this case error should not be thrown. Select query should return result.  After this change, ambiguous error will not be thrown as we are fixing the duplicate attribute match. ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1461262849/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1461279768",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1461279768",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1461279768,
    "node_id": "IC_kwDOAQXtWs5XGVwY",
    "user": {
      "login": "srowen",
      "id": 822522,
      "node_id": "MDQ6VXNlcjgyMjUyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/822522?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/srowen",
      "html_url": "https://github.com/srowen",
      "followers_url": "https://api.github.com/users/srowen/followers",
      "following_url": "https://api.github.com/users/srowen/following{/other_user}",
      "gists_url": "https://api.github.com/users/srowen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/srowen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/srowen/subscriptions",
      "organizations_url": "https://api.github.com/users/srowen/orgs",
      "repos_url": "https://api.github.com/users/srowen/repos",
      "events_url": "https://api.github.com/users/srowen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/srowen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-09T04:58:23Z",
    "updated_at": "2023-03-09T04:58:23Z",
    "author_association": "MEMBER",
    "body": "Hm, how is it not ambiguous? When case insensitive, 'id' could mean one of two different columns ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1461279768/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1461288036",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1461288036",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1461288036,
    "node_id": "IC_kwDOAQXtWs5XGXxk",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-09T05:10:09Z",
    "updated_at": "2023-03-09T05:10:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Hm, how is it not ambiguous? When case insensitive, 'id' could mean one of two different columns\r\n\r\nIt's not ambiguous because the  when we are selecting using list of column names, both id and ID are getting value from same column 'id' in the source dataframe. \r\nval **df1** = sc.parallelize(List((1,2,3,4,5),(1,2,3,4,5))).toDF(\"**id\"**,\"col2\",\"col3\",\"col4\", \"col5\")\r\nval op_cols_mixed_case = List(**\"id\"**,\"col2\",\"col3\",\"col4\", \"col5\", **\"ID\"**)\r\nval df3 = **df1**.select(op_cols_mixed_case.head, op_cols_mixed_case.tail: _*)\r\ndf3.select(\"id\").show()\r\n\r\ndf3.explain()\r\n== Physical Plan ==\r\n*(1) Project [**_1#6 AS id#17**, _2#7 AS col2#18, _3#8 AS col3#19, _4#9 AS col4#20, _5#10 AS col5#21, **_1#6 AS ID#17**]",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1461288036/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1461291351",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1461291351",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1461291351,
    "node_id": "IC_kwDOAQXtWs5XGYlX",
    "user": {
      "login": "srowen",
      "id": 822522,
      "node_id": "MDQ6VXNlcjgyMjUyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/822522?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/srowen",
      "html_url": "https://github.com/srowen",
      "followers_url": "https://api.github.com/users/srowen/followers",
      "following_url": "https://api.github.com/users/srowen/following{/other_user}",
      "gists_url": "https://api.github.com/users/srowen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/srowen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/srowen/subscriptions",
      "organizations_url": "https://api.github.com/users/srowen/orgs",
      "repos_url": "https://api.github.com/users/srowen/repos",
      "events_url": "https://api.github.com/users/srowen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/srowen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-09T05:15:16Z",
    "updated_at": "2023-03-09T05:15:16Z",
    "author_association": "MEMBER",
    "body": "That isn't relevant. You are selecting from a DataFrame with cols id and ID. Imagine for instance they do not come from the same source, it's clearly ambiguous. It wouldn't make sense if it were different in this case. ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1461291351/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1461303721",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1461303721",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1461303721,
    "node_id": "IC_kwDOAQXtWs5XGbmp",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-09T05:21:14Z",
    "updated_at": "2023-03-09T05:21:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "It's very much relevant as this is the only case which requires the fix. If they do not come from same source, the plan  will reflect that and it will throw the ambiguous error even after this fix.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1461303721/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1461314871",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1461314871",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1461314871,
    "node_id": "IC_kwDOAQXtWs5XGeU3",
    "user": {
      "login": "srowen",
      "id": 822522,
      "node_id": "MDQ6VXNlcjgyMjUyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/822522?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/srowen",
      "html_url": "https://github.com/srowen",
      "followers_url": "https://api.github.com/users/srowen/followers",
      "following_url": "https://api.github.com/users/srowen/following{/other_user}",
      "gists_url": "https://api.github.com/users/srowen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/srowen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/srowen/subscriptions",
      "organizations_url": "https://api.github.com/users/srowen/orgs",
      "repos_url": "https://api.github.com/users/srowen/repos",
      "events_url": "https://api.github.com/users/srowen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/srowen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-09T05:34:15Z",
    "updated_at": "2023-03-09T05:34:15Z",
    "author_association": "MEMBER",
    "body": "Hm, I just don't see the logic in that. It isn't how SQL works either, as far as I understand. Here's maybe another example, imagine a DataFrame defined by `SELECT 3 as id, 3 as ID`. Would you also say selecting \"id\" is unambiguous? and it makes sense to you if I change a 3 to a 4 that this query is no longer semantically valid?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1461314871/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1463230011",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1463230011",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1463230011,
    "node_id": "IC_kwDOAQXtWs5XNx47",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-10T04:15:35Z",
    "updated_at": "2023-03-10T04:15:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Hm, I just don't see the logic in that. It isn't how SQL works either, as far as I understand. Here's maybe another example, imagine a DataFrame defined by `SELECT 3 as id, 3 as ID`. Would you also say selecting \"id\" is unambiguous? and it makes sense to you if I change a 3 to a 4 that this query is no longer semantically valid?\r\n\r\nIf it's valid as per the plan then yes. ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1463230011/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1465517104",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1465517104",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1465517104,
    "node_id": "IC_kwDOAQXtWs5XWgQw",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-13T05:04:40Z",
    "updated_at": "2023-03-13T05:05:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Gentle ping @dongjoon-hyun @mridulm @HyukjinKwon @yaooqinn Can you please review this PR or direct it to someone who can review this PR.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1465517104/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1466139560",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1466139560",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1466139560,
    "node_id": "IC_kwDOAQXtWs5XY4Oo",
    "user": {
      "login": "srowen",
      "id": 822522,
      "node_id": "MDQ6VXNlcjgyMjUyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/822522?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/srowen",
      "html_url": "https://github.com/srowen",
      "followers_url": "https://api.github.com/users/srowen/followers",
      "following_url": "https://api.github.com/users/srowen/following{/other_user}",
      "gists_url": "https://api.github.com/users/srowen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/srowen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/srowen/subscriptions",
      "organizations_url": "https://api.github.com/users/srowen/orgs",
      "repos_url": "https://api.github.com/users/srowen/repos",
      "events_url": "https://api.github.com/users/srowen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/srowen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-13T13:23:58Z",
    "updated_at": "2023-03-13T13:23:58Z",
    "author_association": "MEMBER",
    "body": "That's a \"no\" from me, per the logic above",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1466139560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1466394445",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1466394445",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1466394445,
    "node_id": "IC_kwDOAQXtWs5XZ2dN",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-13T15:43:24Z",
    "updated_at": "2023-03-13T15:43:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "> That's a \"no\" from me, per the logic above\r\n\r\nThanks @srowen But seems I am not able to explain the change to you. So it's better to get review from someone who is qualified to review the change and aware of this code.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1466394445/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1476233946",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1476233946",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1476233946,
    "node_id": "IC_kwDOAQXtWs5X_Yra",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-20T13:28:10Z",
    "updated_at": "2023-03-20T13:28:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "Gentle ping @dongjoon-hyun @mridulm @HyukjinKwon @yaooqinn Can you please review this PR or direct it to someone who can review this PR.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1476233946/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1480217186",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1480217186",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1480217186,
    "node_id": "IC_kwDOAQXtWs5YOlJi",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-22T20:26:55Z",
    "updated_at": "2023-03-22T20:26:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Gentle ping @dongjoon-hyun @mridulm @HyukjinKwon @yaooqinn Can you please review this PR or direct it to someone who can review this PR.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1480217186/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1480469070",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1480469070",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1480469070,
    "node_id": "IC_kwDOAQXtWs5YPipO",
    "user": {
      "login": "yaooqinn",
      "id": 8326978,
      "node_id": "MDQ6VXNlcjgzMjY5Nzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8326978?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yaooqinn",
      "html_url": "https://github.com/yaooqinn",
      "followers_url": "https://api.github.com/users/yaooqinn/followers",
      "following_url": "https://api.github.com/users/yaooqinn/following{/other_user}",
      "gists_url": "https://api.github.com/users/yaooqinn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yaooqinn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yaooqinn/subscriptions",
      "organizations_url": "https://api.github.com/users/yaooqinn/orgs",
      "repos_url": "https://api.github.com/users/yaooqinn/repos",
      "events_url": "https://api.github.com/users/yaooqinn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yaooqinn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-23T01:49:10Z",
    "updated_at": "2023-03-23T01:49:10Z",
    "author_association": "MEMBER",
    "body": "I second @srowen ‘s view. cc @cloud-fan",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1480469070/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1480532873",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1480532873",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1480532873,
    "node_id": "IC_kwDOAQXtWs5YPyOJ",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-23T02:56:09Z",
    "updated_at": "2023-03-23T02:56:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I second @srowen ‘s view. cc @cloud-fan\r\n\r\nThanks @yaooqinn for replying. Can you please explain why you think it's not the right fix? \r\nThe fix only proposes to remove duplicates from the resolved columns. As it's incorrect to consider the only one column match as ambiguous just because it occurs more than once in the resolved column list.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1480532873/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1480540953",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1480540953",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1480540953,
    "node_id": "IC_kwDOAQXtWs5YP0MZ",
    "user": {
      "login": "cloud-fan",
      "id": 3182036,
      "node_id": "MDQ6VXNlcjMxODIwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3182036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cloud-fan",
      "html_url": "https://github.com/cloud-fan",
      "followers_url": "https://api.github.com/users/cloud-fan/followers",
      "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}",
      "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions",
      "organizations_url": "https://api.github.com/users/cloud-fan/orgs",
      "repos_url": "https://api.github.com/users/cloud-fan/repos",
      "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cloud-fan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-23T03:08:32Z",
    "updated_at": "2023-03-23T03:08:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think column resolution should only look at one level, to make the behavior simple and predictable. I tried it on pgsql and it fails as well:\r\n```\r\ncreate table t(i int);\r\nselect id from (select i as id, i as ID from t) sub;\r\nERROR: column reference \"id\" is ambiguous Position: 8\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1480540953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1480574606",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1480574606",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1480574606,
    "node_id": "IC_kwDOAQXtWs5YP8aO",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-23T04:08:32Z",
    "updated_at": "2023-03-23T04:08:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "> df3.select(\"id\").show()\r\n\r\n@cloud-fan The example you have shared will behave the same even after this fix. It will give ambiguous error. \r\nThe use case which the fix is trying to solve is different. Can you please try these two cases:\r\nCase 1: which works fine\r\nval df1 = sc.parallelize(List((1,2,3,4,5),(1,2,3,4,5))).toDF(\"id\",\"col2\",\"col3\",\"col4\", \"col5\")\r\nval op_cols_same_case = List(\"id\",\"col2\",\"col3\",\"col4\", \"col5\", \"id\")\r\nval df3 = df1.select(op_cols_same_case.head, op_cols_same_case.tail: _*)\r\ndf3.select(\"id\").show()  \r\n\r\nCase 2: which doesn't work fine and the fix is to solve this issue\r\nval df2 = sc.parallelize(List((1,2,3,4,5),(1,2,3,4,5))).toDF(\"id\",\"col2\",\"col3\",\"col4\", \"col5\")\r\nval op_cols_mixed_case = List(\"id\",\"col2\",\"col3\",\"col4\", \"col5\", \"ID\")\r\nval df4 = df2.select(op_cols_mixed_case.head, op_cols_mixed_case.tail: _*)\r\ndf4.select(\"id\").show()",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1480574606/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1480574647",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1480574647",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1480574647,
    "node_id": "IC_kwDOAQXtWs5YP8a3",
    "user": {
      "login": "yaooqinn",
      "id": 8326978,
      "node_id": "MDQ6VXNlcjgzMjY5Nzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8326978?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yaooqinn",
      "html_url": "https://github.com/yaooqinn",
      "followers_url": "https://api.github.com/users/yaooqinn/followers",
      "following_url": "https://api.github.com/users/yaooqinn/following{/other_user}",
      "gists_url": "https://api.github.com/users/yaooqinn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yaooqinn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yaooqinn/subscriptions",
      "organizations_url": "https://api.github.com/users/yaooqinn/orgs",
      "repos_url": "https://api.github.com/users/yaooqinn/repos",
      "events_url": "https://api.github.com/users/yaooqinn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yaooqinn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-23T04:08:35Z",
    "updated_at": "2023-03-23T04:08:35Z",
    "author_association": "MEMBER",
    "body": "@shrprasa \r\nAt the dataset definition phase, especially for intermediate datasets, Spark is lenient/lazy with case sensitivity. This is because the checks happen in SQL Analyzing, which is not required for defining a Dataset. This gives the user more freedom but also cognitive disorders. On the other hand, in the read phase, SQL Analyzing is a mandatory step, and checks will be performed, so the configuration provided by Spark at this stage is sufficient to resolve all ambiguities.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1480574647/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1480589254",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1480589254",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1480589254,
    "node_id": "IC_kwDOAQXtWs5YP__G",
    "user": {
      "login": "cloud-fan",
      "id": 3182036,
      "node_id": "MDQ6VXNlcjMxODIwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3182036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cloud-fan",
      "html_url": "https://github.com/cloud-fan",
      "followers_url": "https://api.github.com/users/cloud-fan/followers",
      "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}",
      "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions",
      "organizations_url": "https://api.github.com/users/cloud-fan/orgs",
      "repos_url": "https://api.github.com/users/cloud-fan/repos",
      "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cloud-fan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-23T04:33:23Z",
    "updated_at": "2023-03-23T04:33:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "@shrprasa do you know how the case 1 works?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1480589254/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1480595916",
    "html_url": "https://github.com/apache/spark/pull/40258#issuecomment-1480595916",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40258",
    "id": 1480595916,
    "node_id": "IC_kwDOAQXtWs5YQBnM",
    "user": {
      "login": "shrprasa",
      "id": 109815907,
      "node_id": "U_kgDOBouoYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109815907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrprasa",
      "html_url": "https://github.com/shrprasa",
      "followers_url": "https://api.github.com/users/shrprasa/followers",
      "following_url": "https://api.github.com/users/shrprasa/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrprasa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrprasa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrprasa/subscriptions",
      "organizations_url": "https://api.github.com/users/shrprasa/orgs",
      "repos_url": "https://api.github.com/users/shrprasa/repos",
      "events_url": "https://api.github.com/users/shrprasa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrprasa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-23T04:45:49Z",
    "updated_at": "2023-03-23T04:45:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @shrprasa do you know how the case 1 works?\r\n\r\nyes. It works because the resolved column has just one match \r\nattributes: Vector(id#17)\r\n\r\nbut for second case, the match result is\r\nattributes: Vector(id#17, id#17)\r\nSince, there are more than one value although both are exactly same, it fails. This fix proposes to fix this by taking distinct values of match result.\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1480595916/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
