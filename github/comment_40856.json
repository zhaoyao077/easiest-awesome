[
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1515827341",
    "html_url": "https://github.com/apache/spark/pull/40856#issuecomment-1515827341",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40856",
    "id": 1515827341,
    "node_id": "IC_kwDOAQXtWs5aWbCN",
    "user": {
      "login": "peter-toth",
      "id": 7253827,
      "node_id": "MDQ6VXNlcjcyNTM4Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7253827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/peter-toth",
      "html_url": "https://github.com/peter-toth",
      "followers_url": "https://api.github.com/users/peter-toth/followers",
      "following_url": "https://api.github.com/users/peter-toth/following{/other_user}",
      "gists_url": "https://api.github.com/users/peter-toth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/peter-toth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/peter-toth/subscriptions",
      "organizations_url": "https://api.github.com/users/peter-toth/orgs",
      "repos_url": "https://api.github.com/users/peter-toth/repos",
      "events_url": "https://api.github.com/users/peter-toth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/peter-toth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-20T07:14:23Z",
    "updated_at": "2023-04-20T07:14:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "cc @cloud-fan, @maryannxue ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1515827341/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1516386920",
    "html_url": "https://github.com/apache/spark/pull/40856#issuecomment-1516386920",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40856",
    "id": 1516386920,
    "node_id": "IC_kwDOAQXtWs5aYjpo",
    "user": {
      "login": "cloud-fan",
      "id": 3182036,
      "node_id": "MDQ6VXNlcjMxODIwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3182036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cloud-fan",
      "html_url": "https://github.com/cloud-fan",
      "followers_url": "https://api.github.com/users/cloud-fan/followers",
      "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}",
      "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions",
      "organizations_url": "https://api.github.com/users/cloud-fan/orgs",
      "repos_url": "https://api.github.com/users/cloud-fan/repos",
      "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cloud-fan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-20T14:01:35Z",
    "updated_at": "2023-04-20T14:01:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "@peter-toth can you briefly explain the idea of fixing it?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1516386920/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1516659349",
    "html_url": "https://github.com/apache/spark/pull/40856#issuecomment-1516659349",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40856",
    "id": 1516659349,
    "node_id": "IC_kwDOAQXtWs5aZmKV",
    "user": {
      "login": "peter-toth",
      "id": 7253827,
      "node_id": "MDQ6VXNlcjcyNTM4Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7253827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/peter-toth",
      "html_url": "https://github.com/peter-toth",
      "followers_url": "https://api.github.com/users/peter-toth/followers",
      "following_url": "https://api.github.com/users/peter-toth/following{/other_user}",
      "gists_url": "https://api.github.com/users/peter-toth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/peter-toth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/peter-toth/subscriptions",
      "organizations_url": "https://api.github.com/users/peter-toth/orgs",
      "repos_url": "https://api.github.com/users/peter-toth/repos",
      "events_url": "https://api.github.com/users/peter-toth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/peter-toth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-20T16:58:47Z",
    "updated_at": "2023-04-20T17:11:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @peter-toth can you briefly explain the idea of fixing it?\r\n\r\nI've updated the PR recently, but the main change is that the CTE accumulator map argument of `buildCTEMap()` changed from \r\n`mutable.HashMap.empty[Long, (CTERelationDef, Int)]`\r\nto \r\n`mutable.SortedMap.empty[Long, (CTERelationDef, Int, mutable.Map[Long, Int])]`.\r\nThe new `mutable.Map[Long, Int]` part tracks where the references are pointing to from a CTE. (The old `Int` part tracks the \"count of incoming references\".)\r\n\r\nOnce we have this extended outer map we can correct the \"count of incoming references\" in `cleanCTEMap()`. We just need to iterate the CTEs in reverse order (that's why the outer map is now a `SortedMap`) and if we encounter a CTE whose \"count of incoming references\" is 0 then we decrease the referenced CTE's \"count of incoming references\".\r\n\r\nTo build the new inner map `buildCTEMap()` has a new `outerCTEId` optional argument.\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1516659349/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1522924425",
    "html_url": "https://github.com/apache/spark/pull/40856#issuecomment-1522924425",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40856",
    "id": 1522924425,
    "node_id": "IC_kwDOAQXtWs5axfuJ",
    "user": {
      "login": "cloud-fan",
      "id": 3182036,
      "node_id": "MDQ6VXNlcjMxODIwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3182036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cloud-fan",
      "html_url": "https://github.com/cloud-fan",
      "followers_url": "https://api.github.com/users/cloud-fan/followers",
      "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}",
      "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions",
      "organizations_url": "https://api.github.com/users/cloud-fan/orgs",
      "repos_url": "https://api.github.com/users/cloud-fan/repos",
      "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cloud-fan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-26T07:32:06Z",
    "updated_at": "2023-04-26T07:32:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "thanks, merging to master!",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1522924425/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1522932018",
    "html_url": "https://github.com/apache/spark/pull/40856#issuecomment-1522932018",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40856",
    "id": 1522932018,
    "node_id": "IC_kwDOAQXtWs5axhky",
    "user": {
      "login": "peter-toth",
      "id": 7253827,
      "node_id": "MDQ6VXNlcjcyNTM4Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7253827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/peter-toth",
      "html_url": "https://github.com/peter-toth",
      "followers_url": "https://api.github.com/users/peter-toth/followers",
      "following_url": "https://api.github.com/users/peter-toth/following{/other_user}",
      "gists_url": "https://api.github.com/users/peter-toth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/peter-toth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/peter-toth/subscriptions",
      "organizations_url": "https://api.github.com/users/peter-toth/orgs",
      "repos_url": "https://api.github.com/users/peter-toth/repos",
      "events_url": "https://api.github.com/users/peter-toth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/peter-toth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-26T07:38:27Z",
    "updated_at": "2023-04-26T07:38:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @cloud-fan!",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1522932018/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
