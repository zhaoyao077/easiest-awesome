[
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1475524024",
    "html_url": "https://github.com/apache/spark/pull/40405#issuecomment-1475524024",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40405",
    "id": 1475524024,
    "node_id": "IC_kwDOAQXtWs5X8rW4",
    "user": {
      "login": "xinrong-meng",
      "id": 47337188,
      "node_id": "MDQ6VXNlcjQ3MzM3MTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/47337188?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xinrong-meng",
      "html_url": "https://github.com/xinrong-meng",
      "followers_url": "https://api.github.com/users/xinrong-meng/followers",
      "following_url": "https://api.github.com/users/xinrong-meng/following{/other_user}",
      "gists_url": "https://api.github.com/users/xinrong-meng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xinrong-meng/subscriptions",
      "organizations_url": "https://api.github.com/users/xinrong-meng/orgs",
      "repos_url": "https://api.github.com/users/xinrong-meng/repos",
      "events_url": "https://api.github.com/users/xinrong-meng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xinrong-meng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-20T02:33:39Z",
    "updated_at": "2023-03-20T02:33:39Z",
    "author_association": "MEMBER",
    "body": "@zhengruifeng @HyukjinKwon May I get a review, please?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1475524024/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1475525966",
    "html_url": "https://github.com/apache/spark/pull/40405#issuecomment-1475525966",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40405",
    "id": 1475525966,
    "node_id": "IC_kwDOAQXtWs5X8r1O",
    "user": {
      "login": "zhengruifeng",
      "id": 7322292,
      "node_id": "MDQ6VXNlcjczMjIyOTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7322292?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zhengruifeng",
      "html_url": "https://github.com/zhengruifeng",
      "followers_url": "https://api.github.com/users/zhengruifeng/followers",
      "following_url": "https://api.github.com/users/zhengruifeng/following{/other_user}",
      "gists_url": "https://api.github.com/users/zhengruifeng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zhengruifeng/subscriptions",
      "organizations_url": "https://api.github.com/users/zhengruifeng/orgs",
      "repos_url": "https://api.github.com/users/zhengruifeng/repos",
      "events_url": "https://api.github.com/users/zhengruifeng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zhengruifeng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-20T02:36:59Z",
    "updated_at": "2023-03-20T02:36:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "A grouped data can also be created via `df.roll/cube/pivot`, do they works with `applyInPandas` ?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1475525966/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1475669732",
    "html_url": "https://github.com/apache/spark/pull/40405#issuecomment-1475669732",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40405",
    "id": 1475669732,
    "node_id": "IC_kwDOAQXtWs5X9O7k",
    "user": {
      "login": "xinrong-meng",
      "id": 47337188,
      "node_id": "MDQ6VXNlcjQ3MzM3MTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/47337188?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xinrong-meng",
      "html_url": "https://github.com/xinrong-meng",
      "followers_url": "https://api.github.com/users/xinrong-meng/followers",
      "following_url": "https://api.github.com/users/xinrong-meng/following{/other_user}",
      "gists_url": "https://api.github.com/users/xinrong-meng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xinrong-meng/subscriptions",
      "organizations_url": "https://api.github.com/users/xinrong-meng/orgs",
      "repos_url": "https://api.github.com/users/xinrong-meng/repos",
      "events_url": "https://api.github.com/users/xinrong-meng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xinrong-meng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-20T06:02:53Z",
    "updated_at": "2023-03-20T06:03:33Z",
    "author_association": "MEMBER",
    "body": "As long as the input relation is GroupedData, `applyInPandas` works.\r\n\r\nAn example is as shown below:\r\n```sh\r\n>>> df = spark.createDataFrame([(1, 1.0), (1, 2.0), (2, 3.0), (2, 5.0), (2, 10.0)],(\"id\", \"v\"))\r\n>>> \r\n>>> def normalize(pdf):\r\n...     v = pdf.v\r\n...     return pdf.assign(v=(v - v.mean()) / v.std())\r\n... \r\n\r\n>>> df.cube('id').applyInPandas(normalize, schema=\"id long, v double\").show()\r\n+---+-------------------+\r\n| id|                  v|\r\n+---+-------------------+\r\n|  1|-0.7071067811865475|\r\n|  1| 0.7071067811865475|\r\n|  2|-0.8320502943378437|\r\n|  2|-0.2773500981126146|\r\n|  2| 1.1094003924504583|\r\n+---+-------------------+\r\n\r\n>>> df.rollup('id', df.v).applyInPandas(normalize, schema=\"id long, v double\").show()\r\n+---+----+                                                                      \r\n| id|   v|\r\n+---+----+\r\n|  1|null|\r\n|  1|null|\r\n|  2|null|\r\n|  2|null|\r\n|  2|null|\r\n+---+----+\r\n\r\n# I didn't find `df.pivot` in vanilla PySpark.\r\n```\r\nThe above example is verified to have the same result as vanilla PySpark.\r\n\r\nCC @zhengruifeng ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1475669732/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1475716275",
    "html_url": "https://github.com/apache/spark/pull/40405#issuecomment-1475716275",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40405",
    "id": 1475716275,
    "node_id": "IC_kwDOAQXtWs5X9aSz",
    "user": {
      "login": "xinrong-meng",
      "id": 47337188,
      "node_id": "MDQ6VXNlcjQ3MzM3MTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/47337188?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xinrong-meng",
      "html_url": "https://github.com/xinrong-meng",
      "followers_url": "https://api.github.com/users/xinrong-meng/followers",
      "following_url": "https://api.github.com/users/xinrong-meng/following{/other_user}",
      "gists_url": "https://api.github.com/users/xinrong-meng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xinrong-meng/subscriptions",
      "organizations_url": "https://api.github.com/users/xinrong-meng/orgs",
      "repos_url": "https://api.github.com/users/xinrong-meng/repos",
      "events_url": "https://api.github.com/users/xinrong-meng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xinrong-meng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-20T07:00:38Z",
    "updated_at": "2023-03-20T07:00:38Z",
    "author_association": "MEMBER",
    "body": "Rebased to the latest master; no new changes after reviews. ",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1475716275/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1476024481",
    "html_url": "https://github.com/apache/spark/pull/40405#issuecomment-1476024481",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40405",
    "id": 1476024481,
    "node_id": "IC_kwDOAQXtWs5X-lih",
    "user": {
      "login": "HyukjinKwon",
      "id": 6477701,
      "node_id": "MDQ6VXNlcjY0Nzc3MDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6477701?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/HyukjinKwon",
      "html_url": "https://github.com/HyukjinKwon",
      "followers_url": "https://api.github.com/users/HyukjinKwon/followers",
      "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}",
      "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions",
      "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs",
      "repos_url": "https://api.github.com/users/HyukjinKwon/repos",
      "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-20T11:03:50Z",
    "updated_at": "2023-03-20T11:05:22Z",
    "author_association": "MEMBER",
    "body": "Merged to master.",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1476024481/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1476027639",
    "html_url": "https://github.com/apache/spark/pull/40405#issuecomment-1476027639",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40405",
    "id": 1476027639,
    "node_id": "IC_kwDOAQXtWs5X-mT3",
    "user": {
      "login": "HyukjinKwon",
      "id": 6477701,
      "node_id": "MDQ6VXNlcjY0Nzc3MDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6477701?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/HyukjinKwon",
      "html_url": "https://github.com/HyukjinKwon",
      "followers_url": "https://api.github.com/users/HyukjinKwon/followers",
      "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}",
      "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions",
      "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs",
      "repos_url": "https://api.github.com/users/HyukjinKwon/repos",
      "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-20T11:05:34Z",
    "updated_at": "2023-03-20T11:05:34Z",
    "author_association": "MEMBER",
    "body": "It has a conflict with 3.4. mind creating a PR to backport this?",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1476027639/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/apache/spark/issues/comments/1476032014",
    "html_url": "https://github.com/apache/spark/pull/40405#issuecomment-1476032014",
    "issue_url": "https://api.github.com/repos/apache/spark/issues/40405",
    "id": 1476032014,
    "node_id": "IC_kwDOAQXtWs5X-nYO",
    "user": {
      "login": "xinrong-meng",
      "id": 47337188,
      "node_id": "MDQ6VXNlcjQ3MzM3MTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/47337188?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xinrong-meng",
      "html_url": "https://github.com/xinrong-meng",
      "followers_url": "https://api.github.com/users/xinrong-meng/followers",
      "following_url": "https://api.github.com/users/xinrong-meng/following{/other_user}",
      "gists_url": "https://api.github.com/users/xinrong-meng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xinrong-meng/subscriptions",
      "organizations_url": "https://api.github.com/users/xinrong-meng/orgs",
      "repos_url": "https://api.github.com/users/xinrong-meng/repos",
      "events_url": "https://api.github.com/users/xinrong-meng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xinrong-meng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-20T11:08:11Z",
    "updated_at": "2023-03-20T11:08:11Z",
    "author_association": "MEMBER",
    "body": "Sure, I'll do. Thanks @HyukjinKwon!",
    "reactions": {
      "url": "https://api.github.com/repos/apache/spark/issues/comments/1476032014/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
